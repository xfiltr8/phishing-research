function computeObj(e){var o=this;this.model=e;this.compid="Refidata";this.stamp1;var x=null;var i=null;var l="loan_table_size";var r="refi_axis_val";var n="home_loanamt";var A="home_loanrate";var q="home_loanterm";var w="home_mopmt";var t="home_mopaid";var d="home_loanbal";var j="refi_loanrate";var a="refi_loanterm";var p="refi_loanpts";var y="refi_othcosts";var h="refi_mopmt";var b="savingsrate";var v="refi_curloanint";var s="refi_newloanint";var g="more_less_options";var c="brkevntxt";var k=768;var f=390;var m=225;var z=["bd3408","63659c","7b9aad","007d00","ff0000","efd773","73d773"];var u=null;this.getDataValue=function(B){return o.model.getItem(B).getValue()};this.getDataItem=function(B){return o.model.getItem(B)};this.setDataValue=function(C,D){var B=o.model.getItem(C);if(B!=null){B.setValue(D)}};this.getTableValue=function(B){return o.model.getItem(B).getValueAtCursor()};this.comp_home_mopmt=function(){var E=o.getDataValue(n);var D=o.getDataValue(A)/12;var C=o.getDataValue(q)*12;var B=vc_math.pvp(D,1,C);return(E/B)};this.comp_home_loanbal=function(){var E=o.getDataValue(n);var D=o.getDataValue(A)/12;var G=o.getDataValue(t);var B=o.getDataValue(w);for(var C=0;E>0&&C<G;C++){var F=E*D;E-=(B-F)}return E};this.comp_refi_mopmt=function(){var B=o.getDataValue(d);var E=o.getDataValue(j)/12;var D=o.getDataValue(a)*12;var C=vc_math.pvp(E,1,D);return(B/C)};this.comp_refi_curloanint=function(){var H=o.getDataValue(d);var F=o.getDataValue(A)/12;var C=(o.getDataValue(q)*12)-o.getDataValue(t);var B=o.getDataValue(w);var E=0;for(var D=0;H>0&&D<C;D++){var G=H*F;H-=(B-G);E+=G}return E};this.comp_refi_newloanint=function(){var H=o.getDataValue(d);var F=o.getDataValue(j)/12;var C=o.getDataValue(a)*12;var B=o.getDataValue(h);var E=0;for(var D=0;H>0&&D<C;D++){var G=H*F;H-=(B-G);E+=G}return E};this.comp_mopmt_diff=function(){return Math.abs(o.getDataValue(h)-o.getDataValue(w))};this.comp_mopmt_diff_text=function(){var E="";var D=o.getDataItem(g);if(D!=null){var C=o.getDataValue(h)-o.getDataValue(w);var B=(C<0)?1:0;E=D.getCellValue(0,B)}return E};this.comp_loanint_diff=function(){return Math.abs(o.getDataValue(s)-o.getDataValue(v))};this.comp_loanint_diff_text=function(){var E="";var D=o.getDataItem(g);if(D!=null){var C=o.getDataValue(s)-o.getDataValue(v);var B=(C<0)?1:0;E=D.getCellValue(0,B)}return E};this.build_loan_tables=function(){var K=o.getDataValue(l);var D=K/12;if(x==null){x=new Array(K);i=new Array(K)}var E=o.getDataValue(w)-o.getDataValue(h);var F=0;if(E<0){F-=E;E=0}var G=o.getDataValue(b)/12;var I=o.getDataValue(p)*o.getDataValue(d)/100+o.getDataValue(y);var H=0;var J=0;for(var C=0;C<D;C++){for(var B=0;B<12;B++){I=I*(1+G)+F;H=H*(1+G)+E;x[J+B]=I;i[J+B]=H}J+=12}};this.build_table_data_string=function(D){var B=""+D+";2;0;1;1;nil;Current Loan;New Loan";for(var C=0;C<D;C++){B+=";"+(C+1)+";"+roundit(x[C],0.01)+";"+roundit(i[C],0.01)}return B};this.comp_refi_gdata=function(){o.build_loan_tables();return 0};this.comp_refi_bemos=function(){var E=0;var G=0;var F=x[0]-i[0];if(F>0){var B=o.getDataValue(r);G=1;for(var C=1;C<B;C++){var D=x[C]-i[C];if(D<=0){D=-D;E=C+Math.floor((F/(F+D))+0.999);G=0;break}F=D}}o.setDataValue(c,G);return E};this.comp_refi_axis_val=function(){var B=Math.max(o.getDataValue(q),o.getDataValue(a))*12;return B};this.getColorPalette=function(){if(u==null){u=z;var D=document.getElementById("vcapp");if(D){var B=D.getAttribute("data-graph-colors");if(B){var C=B.split(",");if(C&&$.isArray(C)&&C.length>=7){u=C}}}}return u};this.getGraphColors=function(){var B=o.getColorPalette();return B[0]+";"+B[1]};this.processGraphPost=function(B){o.model.resumeComputes()};this.comp_gpost=function(G,B){var E=o.getDataValue(r);var D=o.build_table_data_string(E);o.stamp1=Math.random();var C=Math.min(screen.width,screen.height)<k?f:550;var F=Math.min(screen.width,screen.height)<k?m:300;vc_app.postGraphData(o.stamp1,"ctpl=refinancegraph.tpl|ctype=png|imgw="+C+"|imgh="+F+"|payoffperiod="+E+"|colors="+o.getGraphColors()+"|gdata="+D,o.processGraphPost);o.model.suspendComputes(G,B);return""};this.comp_graph1=function(){var C=vc_app.getGraphHandler();var B=C+"?gdataid="+o.stamp1;return B};this.processVarChange=function(C){var D="";var F=0;var E=o.getDataValue(q)*12;var B=o.getDataValue(t);if(C==t){if(B>=E){F=E-1;D=C}}else{if(C==q){if(E<=B){F=Math.round(B/12)+1;D=C}}}if(D.length>0){o.setDataValue(D,F);C=D}return C}};