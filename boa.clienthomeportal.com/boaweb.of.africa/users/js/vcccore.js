var vc_app=null;var vc_log=null;var vc_math=new VCMath();var COREVERSION="4.56.$LastChangedRevision$";function VCLog(f,d){var e=this;this.debugmode=f;this.debuglog="";this.imgpath=(d&&d!=null)?d:"images/";this.addToLog=function(a,b){e.debuglog+=a+"\n";if(e.debugmode){if(b){e.showLogs()}}};this.dispMsg=function(a){if(e.debugmode){alert(a)}};this.showLogs=function(){if(e.debugmode){alert("Application version: "+vc_app.getAppVer()+"\nUICore version: "+vc_app.getCoreVer()+"\n"+e.debuglog);e.addToLog("----------------",false)}};this.clearLog=function(){e.debuglog=""};this.toggleDebugMode=function(){e.debugmode=!e.debugmode;e.switchButton()};this.setDbgMarkup=function(){if(e.debugmode){var b=document.getElementById("debugcover");if(b){var a=vc_app;b.innerHTML='<div class="dbgicon"><a onmouseover=\'this.style.cursor="pointer";\' onfocus="this.blur();" onclick="vc_log.showLogs()"><img src="'+e.imgpath+'debug.png" border=0></a></div>';e.switchButton()}}};this.isDebugMode=function(){return e.debugmode};this.switchButton=function(){if(e.dbgmode){$(".debug").css("display","block")}else{$(".debug").css("display","none")}}}function VCApp(c){var d=this;this.appname=c;this.controller=null;this.slidercontroller=null;this.logmode=false;this.loadsession=false;this.appusessliders=false;this.clearsess=false;this.userid=null;this.sessionObj=null;this.apphelp=null;this.curpageid=null;this.corever=COREVERSION;this.appmodel=null;this.appview=null;this.appsess="loading";this.appudata="loading";this.appglob="loading";this.directload=false;this.descpath="";this.imgpath="images/";this.hlppath="help/";this.init=function(q,p,o,s,v,t,a,u,r){d.directload=(a&&a!=null&&a!="")?true:false;d.descpath=d.directload?a:"";d.imgpath=(u&&u!=null)?u:"images/";d.hlppath=(r&&r!=null&&r!="")?(r+"help/"):"help/";d.curpageid=q;d.loadsession=p;d.appusessliders=s;d.userid=o;var b=new VCController(d.appname,p,o,s,v,t,d.imgpath);if(d.directload){b.setDirectLoad(d.descpath)}d.controller=b;d.setPageDecor();b.loadAppData(d.appname,o,p,d.processAppData);if(s){d.slidercontroller=createSliderController()}else{d.slidercontroller=null}d.apphelp=d.createHelpObject((typeof helpbundle==="undefined")?defbundle:helpbundle);d.setUI(q);vc_log.addToLog("end of initialization",false)};this.setAppModel=function(a){d.appmodel=a};this.setAppView=function(a){d.appview=a};this.setAppSessionData=function(a){d.appsess=a};this.setAppGlobalData=function(a){d.appglob=a};this.setAppUserData=function(a){d.appudata=a};this.postGraphData=function(h,b,a){d.controller.postGraphData(h,b,a)};this.getAppModel=function(){return d.appmodel};this.getAppView=function(){return d.appview};this.getAppSessionData=function(){return d.appsess};this.getAppGlobalData=function(){return d.appglob};this.getAppUserData=function(){return d.appudata};this.getAppVer=function(){return"yyy"};this.getCoreVer=function(){return d.corever};this.getSliderController=function(){return d.slidercontroller};this.getGraphHandler=function(){return d.controller.getGraphHandler()};this.getImageLoc=function(){return d.imgpath};this.getHelpLoc=function(){return d.hlppath};this.createHelpObject=function(a){if(a){d.apphelp=helpObject(a)}return d.apphelp};this.setPageDecor=function(){d.setFooter()};this.setUI=function(a){d.curpageid=a;waitForViewAndSetUI()};this.setFooter=function(){var a=document.getElementById("version");if(a){a.innerHTML="Version "+d.corever}};this.processAppData=function(b){var g=null;try{g=jQuery.parseJSON(b)}catch(s){}var q=(g==null)?b:g;if(q.results.status!="OK"){var u=q.results.errors.error;alert(u);return}var t=new modelObject(q.results.modeldesc);d.setAppModel(t);vc_log.addToLog("Data descriptor loaded",false);var p=new viewObject(q.results.uidesc);d.setAppView(p);vc_log.addToLog("UI descriptor loaded",false);var r=q.results.globaldata;vc_app.setAppGlobalData(r);if(r==null){vc_log.addToLog("Loaded global data object was empty",false)}else{vc_log.addToLog("Global data loaded",false)}var m=q.results.userdata;vc_app.setAppUserData(m);if(m==null){vc_log.addToLog("Loaded user data object was empty",false)}else{vc_log.addToLog("User data loaded",false)}var a=q.results.sessiondata;vc_app.setAppSessionData(a);if(a==null){vc_log.addToLog("Loaded Session was empty",false)}else{vc_log.addToLog("Session loaded",false)}};this.navPanelClicked=function(a,b){var f=d.appview.findNavPanel(a);if(f==null){return}else{f.setCurrentPanel(b)}}}function VCController(l,q,j,o,p,n,m){var k=this;this.appname=l;this.handler=p;this.ghandler=n;this.directload=false;this.descloc="";this.descfmt="json";this.imgpath=m;this.setDirectLoad=function(a){k.descloc=a;k.directload=true};this.getHandler=function(){return k.handler};this.setHandler=function(a){k.handler=a};this.getGraphHandler=function(){return k.ghandler};this.setGraphHandler=function(a){k.ghandler=a};this.getImageLoc=function(){return k.imgpath};this.loadDescriptors=function(b,c,a){vc_log.addToLog("Initializing Page "+b,false);vc_log.addToLog("calling for data desc",false);k.loadFromHandler("getdatadescriptor",k.appname,c);vc_log.addToLog("calling for ui desc",false);k.loadFromHandler("getuidescriptor",k.appname,a)};this.loadUserData=function(b,a){if(b!=null){k.loadUserDataFromHandler("getuserdata",k.appname,b,a)}else{a("ignore")}};this.loadAppData=function(e,c,d,b){if(k.directload){var a=k.descloc+e+"."+k.descfmt;$.post(a,{},function(f){b(f)},k.descfmt)}else{$.post(k.handler,{method:"getappdata",appname:e,userid:c,ldsess:d},function(f){b(f)},"json")}};this.loadFromHandler=function(c,a,b){$.post(k.handler,{method:c,appname:a},function(d){b(d)},"json")};this.loadUserDataFromHandler=function(d,a,c,b){$.post(k.handler,{method:d,userid:c,appname:a},function(e){b(e)},"json")};this.loadSessionData=function(a,b){$.post(k.handler,{method:"getsessiondata"},function(c){b(c)},"json")};this.saveSessionData=function(a,c,b){$.post(k.handler,{method:"savesessiondata",appname:a,data:JSON.stringify(c)},function(d){k.processStatus("saving session data",d,b)},"json")};this.saveSessionDataExt=function(a,b,c){$.post(k.handler,{method:"savesessiondata",appname:a,data:JSON.stringify(b)},function(d){c(d)},"json")};this.clearSessionData=function(a){$.post(k.handler,{method:"clearsessiondata"},function(b){k.processStatus("clearing session data",b)},"json")};this.callPost=function(b,a,c){$.post(k.handler,{method:b,data:a},function(d){c(d)},"json")};this.callPostExt=function(b,c,a,d){$.post(b,{method:c,data:a},function(e){d(e)},"json")};this.postGraphData=function(a,b,c){$.post(k.handler,{method:"storegraphdata",gdataid:a,gdata:b},function(d){c(d)},"json")};this.processStatus=function(c,a,e){var d=jQuery.parseJSON(JSON.stringify(a));var b="";if(d==null){b="no data returned"}else{if(d.results.status!="OK"){b=d.results.error}else{if((e!=undefined)&&(e!="")){window.location.href=e}return}}alert("There was an error while "+c+":"+b)}}function createApp(q,m,o,n,p,t,s,l,u){var r=false;vc_log=new VCLog(r,u);vc_app=new VCApp(q);vc_app.init(m,o,n,p,t,s,l,u)}function waitForSessionProcess(){if(processingSession==true){if(timerObj){clearTimeout(timerObj);timerObj=null}}timerObj=setTimeout("waitForSessionProcess ()",synctime)}function modelObject(o){var self=this;this.dataitems=new Array();this.compobj=null;this.id=null;this.computeorder=null;this.hasMS=false;this.compstate="free";this.resumept="";this.chgditem=null;this.modelinitialized=false;this.getModelID=function(){return self.id};this.getItem=function(did){var item=self.dataitems[did];return item};this.getDataValue=function(did){return self.dataitems[did].getValue()};this.setDataValue=function(did,newval){return self.dataitems[did].setValue(newval)};this.serialize=function(){var s={serdata:{dataitem:[]}};for(var i in self.dataitems){if(i=="indexOf"){continue}var item=self.getItem(i);if(item.isSerializable()){s.serdata.dataitem.push(item.serialize())}}return s};this.deserialize=function(dser,recomp){try{if(dser!=null){var nitems=0;try{nitems=dser.serdata.dataitem.length}catch(err){if(dser.serdata.dataitem==undefined){nitems=0}else{nitems=1}}for(var i=0;i<nitems;i++){var seritem=nitems>1?dser.serdata.dataitem[i]:dser.serdata.dataitem;var id=seritem.name;var item=self.getItem(id);if(item){item.deserialize(seritem)}}vc_log.addToLog("Deserialized "+nitems+" data items",false);if(nitems==0){return}}else{vc_log.addToLog("Empty session nothing to deserialize",false);return}}catch(error){vc_log.addToLog("Error while deserializing session data:"+error,false)}if(recomp==undefined||recomp==true){self.setInitialized(false);self.recompute();self.setInitialized(true)}};this.setInitialized=function(i){self.modelinitialized=i};this.isInitialized=function(){return self.modelinitialized};this.suspendComputes=function(cid,chgditem){self.resumept=cid;self.compstate="suspended";self.chgditem=chgditem};this.resumeComputes=function(){self.compstate="resuming";self.recompute(self.chgditem)};this.recompute=function(chgditem){if(self.compobj){if(self.compobj.processVarChange&&chgditem&&chgditem!=null){self.compobj.processVarChange(chgditem)}if(self.computeorder!=null){if(self.compstate=="free"||self.compstate=="resuming"){var len=self.computeorder.length;for(var i=0;i<len;i++){var compid=self.computeorder[i];var item=self.getItem(compid);if(self.compstate=="resuming"){if(self.resumept==compid){self.compstate="busy";self.resumept="";self.chgditem=null}continue}else{if(self.compstate!="suspended"){var compfunc=item.getComputeFunc();if(compfunc&&(!item.isMultiSolveItem()||item.isMultiSolveOutput())){var val=eval("self.compobj.comp_"+compfunc+" ( compid, chgditem )");item.setValue(val)}}}}if(self.compstate!="suspended"){self.compstate="free";self.resumept="";vc_log.addToLog("Recomputed "+len+" items",false);vc_app.getAppView().refreshUI()}}}else{vc_log.addToLog("Missing compute-order",false)}}else{vc_log.addToLog("Compute object not found",false)}};self.id=o.model.id;if(o.model.dataitem){var ilen=o.model.dataitem.length?o.model.dataitem.length:1;for(var i=0;i<ilen;i++){var ditem=ilen==1?o.model.dataitem:o.model.dataitem[i];var item=new dataItem(this,ditem);self.dataitems[ditem.id]=item;self.hasMS=self.hasMS||item.isMultiSolveItem()}var orderstr=o.model.computeorder;if(orderstr){self.computeorder=orderstr.split(",")}self.compobj=new computeObj(this)}}function dataItem(d,f){var e=this;this.parent=d;this.id=f.id;this.name=f.name;this.type=f.type;this.computefunc=f.computefunc;this.multisolve=f.multisolve;this.msoutput=false;this.obj=null;this.serializable=f.serialize;this.dfmt=f.dfmt?f.dfmt:"";this.getComputeFunc=function(){return e.computefunc};this.getID=function(){return e.id};this.getName=function(){return e.name};this.getType=function(){return e.type};this.isDiscrete=function(){return false};this.isSerializable=function(){return e.serializable!="no"};this.isMultiSolveItem=function(){return e.multisolve};this.isMultiSolveOutput=function(){return e.msoutput};this.setMultiSolveOutput=function(b,a,c){e.msoutput=b;if(!e.msoutput){if(e.getValue()>c){e.setValue(c)}else{if(e.getValue()<a){e.setValue(a)}}}};this.getValue=function(){return e.obj.getValue()};this.setValue=function(a){e.obj.setValue(a)};this.getValueAtCursor=function(){return e.obj.getValueAtCursor()};this.getCurValue=function(){return e.obj.getCurValue()};this.setCurValue=function(a){e.obj.setCurValue(a)};this.setDefValue=function(a){e.obj.setDefValue(a)};this.setDefValues=function(b,a){e.obj.setDefValues(b,a)};this.isVector=function(){return e.obj.isVector()};this.isTree=function(){return e.obj.isTree()};this.getNumRows=function(){return e.obj.getNumRows()};this.getNumCols=function(){return e.obj.getNumCols()};this.getNumNodes=function(){return e.obj.getNumNodes()};this.getNodes=function(){return e.obj.getNodes()};this.findNode=function(a){return e.obj.findNode(a)};this.hasHdrRow=function(){return e.obj.hasHdrRow()};this.getCornerHeader=function(){return e.obj.getCornerHeader()};this.getColHeader=function(a){return e.obj.getColHeader(a)};this.getRowHeader=function(a){return e.obj.getRowHeader(a)};this.setColHeader=function(a,b){e.obj.setColHeader(a,b)};this.setRowHeader=function(a,b){e.obj.setRowHeader(a,b)};this.getCell=function(b,a){return e.obj.getCell(b,a)};this.getCellValue=function(b,a){return e.obj.getCellValue(b,a)};this.setCellValue=function(b,a,c){return e.obj.setCellValue(b,a,c)};this.getElValue=function(c){var a=e.getNumCols();var h=Math.floor(c/a);var b=c-a*h;return e.obj.getCellValue(h,b)};this.setElValue=function(c,k){var a=e.getNumCols();var j=Math.floor(c/a);var b=c-a*j;return e.obj.setCellValue(j,b,k)};this.serialize=function(){return e.obj.serialize()};this.deserialize=function(a){e.obj.deserialize(a)};this.addRows=function(a){return e.obj.addRows(a)};this.delRows=function(a){return e.obj.delRows(a)};this.addColumns=function(a){return e.obj.addColumns(a)};this.delColumns=function(a){return e.obj.delColumns(a)};this.getItem=function(){return e.obj};this.getDefFmt=function(){return e.dfmt};this.getDataType=function(){return e.obj.getDataType()};this.getCellDataType=function(b,a){return e.obj.getCellDataType(b,a)};if(f.ncols>0&&f.nrows>0&&f.type=="tbl"){e.obj=new vectorItem(f,e)}else{if(f.type=="tree"){e.obj=new treeItem(f,e,true)}else{e.obj=new scalarItem(f,e)}}}function scalarItem(e,b){var f=this;this.base=b;this.curval=e.curval;this.getID=function(){return f.base.getID()};this.getName=function(){return f.base.getName()};this.hasNoValue=function(){return(f.curval==null)};this.getValue=function(){if(f.curval!=null){if(f.base.getType()=="num"){return f.curval-0}return""+f.curval}else{return null}};this.setValue=function(a){if(f.base.getType()=="num"&&a!=null){a=a-0}if(f.curval!=a){f.curval=a;return true}return false};this.getValueAtCursor=function(){return f.getValue()};this.getCurValue=function(){return f.getValue()};this.setCurValue=function(a){return f.setValue(a)};this.getDataType=function(){return f.base.getType()};this.getCellDataType=function(a,c){return f.base.getType()};this.setDefValue=function(a){return f.setValue(a)};this.setDefValues=function(a,c){return f.setValue(c[0])};this.isVector=function(){return false};this.isTree=function(){return false};this.hasHdrRow=function(){return false};this.getNumRows=function(){return 0};this.getNumCols=function(){return 0};this.getNumNodes=function(){return 0};this.getNodes=function(){return null};this.findNode=function(a){return null};this.getCornerHeader=function(){return f.base.getName()};this.getColHeader=function(a){return f.base.getName()};this.getRowHeader=function(a){return f.base.getName()};this.setColHeader=function(c,a){};this.setRowHeader=function(c,a){};this.getCell=function(a,c){return f};this.getCellValue=function(a,c){return f.getContent()};this.setCellValue=function(d,c,a){return f.setValue(a)};this.serialize=function(){var a={name:f.getID(),isvec:"0",value:f.getValue()};return a};this.deserialize=function(a){if(a.isvec==1){vc_log.addToLog(f.getName()+"(sc):"+f.getValue()+"--->"+a.value[0]+"(vc)",false);return f.setValue(a.value[0]!=undefined?a.value[0]:a.value)}else{vc_log.addToLog(f.getName()+"(sc):"+f.getValue()+"--->"+a.value,false);if(a.value!=undefined){return f.setValue(a.value)}return false}};this.addRows=function(a){return 0};this.delRows=function(a){return 0};this.addColumns=function(a){return 0};this.delColumns=function(a){return 0}}function vectorItem(j,b){var m=this;this.base=b;this.hdrrow=null;this.modelrow=null;this.rows=[];this.curval=j.curval;this.numcols=Math.round(j.ncols-0);this.numrows=Math.round(j.nrows-0);this.getID=function(){return m.base.getID()};this.getName=function(){return m.base.getName()};this.getValue=function(){return m.getCurValue()};this.getValueAtCursor=function(){var a=m.getCurValue();var c=a%m.numcols;var d=Math.floor(a/m.numcols);return m.getCellValue(d,c)};this.setValue=function(a){return m.setCurValue(a)};this.getCurValue=function(){return m.curval-0};this.setCurValue=function(a){a=a-0;if(m.curval!=a){m.curval=a;return true}return false};this.getDataType=function(){return m.getCellDataType(0,0)};this.getCellDataType=function(a,c){return m.rows[a].getType(c)};this.setDefValue=function(t){var e=0;if(t[0]==undefined){e=t;for(var s=0;s<m.getNumRows();s++){for(var d=0;d<m.getNumCols();d++){m.setCellValue(s,d,e)}}}else{var a=m.getNumRows();var c=m.getNumCols();var f=t.length;var g=0;var u=0;if(f==a){g=1}else{if(f==c){u=1}else{if(f==(a*c)){g=c;u=1}}}for(var s=0;s<a;s++){var r=s*g;for(var d=0;d<c;d++){e=t[r+(d*u)];m.setCellValue(s,d,e)}}}};this.setDefValues=function(g,c){var a=false;var e=c[0];for(var f=0;f<m.getNumRows();f++){if(g=="yes"){e=c[f]}for(var d=0;d<m.getNumCols();d++){if(g!="yes"){e=c[d]}a=m.setCellValue(f,d,e)||a}}return a};this.isVector=function(){return true};this.isTree=function(){return false};this.hasHdrRow=function(){if(m.getCornerHeader()==""){for(var a=0;a<m.getNumCols();a++){if(m.getColHeader(a)==""){continue}else{return true}}}else{return true}return false};this.getNumNodes=function(){return 0};this.getNodes=function(){return null};this.findNode=function(a){return null};this.getNumRows=function(){return m.numrows};this.getNumCols=function(){return m.numcols};this.getCornerHeader=function(){return m.hdrrow.getHeader()};this.getColHeader=function(a){return m.hdrrow.getColHeader(a)};this.getRowHeader=function(a){return m.rows[a].getHeader()};this.setColHeader=function(c,a){m.hdrrow.setColHeader(c,a)};this.setRowHeader=function(c,a){m.rows[c].setHeader(a)};this.getCell=function(a,c){return m.rows[a].getCol(c)};this.getCellValue=function(a,c){return m.rows[a].getCol(c).getContent()};this.setCellValue=function(d,c,a){return m.rows[d].getCol(c).setContent(a)};this.serialize=function(){var d=m.getNumRows();var o=m.getNumCols();var c=[];var g=0;for(var e=0;e<d;e++){for(var a=0;a<o;a++){c[g]=m.getCellValue(e,a);g++}}var f={name:m.getID(),isvec:"1",value:c,rows:d,cols:o,curval:m.getCurValue()};return f};this.deserialize=function(w){var c=false;if(w.isvec==1){var d=w.rows;var v=w.cols;var t=0;var u="";for(var e=0;e<m.getNumRows();e++){for(var g=0;g<m.getNumCols();g++){u+=m.getCellValue(e,g)+";"}}vc_log.addToLog(m.getName()+"(vc) old:"+u,false);var a=m.getNumRows();var f=m.getNumCols();if(d>a){a=m.addRows(d-a);c=true}else{if(d<a){a=m.delRows(a-d);c=true}}if(v>f){m.addColumns(v-f);c=true}else{if(v<f){m.delColumns(f-v);c=true}}for(var e=0;e<d;e++){for(var g=0;g<v;g++){if(w.value[t]!=undefined){c=m.setCellValue(e,g,w.value[t])||c}else{if(e==0&&g==0&&w.value!=undefined){c=m.setCellValue(e,g,w.value)||c}}t++}}u="";for(var e=0;e<m.getNumRows();e++){for(var g=0;g<m.getNumCols();g++){u+=m.getCellValue(e,g)+";"}}c=m.setCurValue(w.curval)||c;vc_log.addToLog(m.getName()+"(vc) new:"+u,false)}else{if(w.value!=undefined){vc_log.addToLog(m.getName()+"(vc):"+m.getCellValue(0,0)+"--->"+w.value+"(sc)",false);c=m.setCellValue(0,0,w.value)||c}else{vc_log.addToLog(m.getName()+"(vc):"+m.getCellValue(0,0)+"--->deser value undefined",false)}}return c};this.addRows=function(c){c=Math.round(c);var e=m.getNumRows();var d=m.getNumCols();for(var a=0;a<c;a++){m.rows[e+a]=(e==0?createTblRow(m.modelrow,d,m.hdrrow):cloneTblRow(m.rows[e-1]))}m.numrows+=c;return m.numrows};this.delRows=function(c){c=Math.round(c);var a=m.getNumRows();if(c>a){c=a}m.rows.length-=c;m.numrows-=c;return m.numrows};this.addColumns=function(a){a=Math.round(a);var c=m.getNumRows();m.hdrrow.addColumns(a);for(var d=0;d<c;d++){m.rows[d].addColumns(a)}m.numcols+=a;return a};this.delColumns=function(a){a=Math.round(a);var c=m.getNumCols();if(a>c){a=c}m.hdrrow.delColumns(a);for(var d=0;d<k;d++){m.rows[d].delColumns(a)}m.numcols-=a;return a};var k=m.numrows;var h=m.numcols;m.hdrrow=new TblHdrRow(j.hrow,h);m.modelrow=k>1?j.row[0]:j.row;for(var l=0;l<k;l++){m.rows[l]=createTblRow(k>1?j.row[l]:j.row,h,m.hdrrow)}}function treeItem(g,b,h,j){var k=this;this.base=b;this.isroot=h;this.curval=g.curval;this.type=g.celltype;this.parent=j;this.nnodes=0;this.node=[];this.getID=function(){return k.base.getID()};this.getName=function(){return k.base.getName()};this.getValue=function(){if(k.type=="num"){return k.curval-0}return k.curval};this.setValue=function(a){if(k.type=="num"){a=a-0}k.curval=a};this.getCurValue=function(){return k.getValue()};this.setCurValue=function(a){k.setValue(a)};this.setDefValue=function(c){var a=c[0]==undefined?c:c[0];k.setValue(a)};this.setDefValues=function(a,c){var d=c[0]==undefined?c:c[0];k.setValue(d)};this.isVector=function(){return false};this.isTree=function(){return true};this.getNumRows=function(){return 0};this.getNumCols=function(){return 0};this.getCornerHeader=function(){return k.base.getName()};this.getColHeader=function(a){return k.base.getName()};this.getRowHeader=function(a){return k.base.getName()};this.setColHeader=function(c,a){};this.setRowHeader=function(c,a){};this.getNumNodes=function(){return k.nnodes};this.hasChildren=function(){return k.nnodes>0};this.getNodes=function(){if(k.nnodes>0){return k.node}return null};this.findNode=function(a){return k.node[a]};this.getCell=function(a,c){return k};this.getCellValue=function(a,c){return k.getContent()};this.setCellValue=function(d,c,a){return k.setValue(a)};this.serialize=function(){var c=[];var a=0;for(var d in k.node){if(d=="indexOf"){continue}c[a]=k.node[d].serialize();a++}if(a>0){return{name:k.getID(),value:k.getValue(),istree:"1",tnode:c}}else{return{name:k.getID(),value:k.getValue(),istree:"1"}}};this.deserialize=function(a){if(a.istree==1){k.init(a,true)}};this.addRows=function(a){return 0};this.addColumns=function(a){return 0};this.init=function(f,n){if(f.value!=undefined){k.setValue(f.value)}try{if(f.tnode){var c=f.tnode.length?f.tnode.length:1;for(var d=0;d<c;d++){var o=c>1?f.tnode[d]:f.tnode;var e=o.id;if(n&&k.node[e]){k.node[nid].deserialize(o)}else{k.node[e]=new TreeNode(o,d);k.nnodes=d+1}}}}catch(a){}};k.init(g,false)}function TreeNode(d,f){var e=this;this.id=d.id;this.ord=f;this.name=d.name;this.value="";this.nnodes=0;this.node=[];this.getID=function(){return e.id};this.getOrd=function(){return e.ord};this.getNumNodes=function(){return e.nnodes};this.getNodes=function(){if(e.nnodes>0){return e.node}return null};this.findNode=function(a){return e.node[a]};this.hasChildren=function(){return e.nnodes>0};this.getName=function(){return e.name};this.getValue=function(){return e.value};this.setValue=function(a){e.value=a};this.deserialize=function(a){e.init(a,true)};this.serialize=function(){var a=[];var c=0;for(var b in e.node){if(b=="indexOf"){continue}a[c]=e.node[b].serialize();c++}if(c>0){return{name:e.getID(),value:e.getValue(),tnode:a}}else{return{name:e.getID(),value:e.getValue()}}};this.init=function(m,n){if(m.content!=undefined){e.value=m.content}else{if(m.value!=undefined){e.value=m.value}}try{if(m.tnode){var a=m.tnode.length?m.tnode.length:1;for(var b=0;b<a;b++){var o=a>1?m.tnode[b]:m.tnode;var c=o.id;if(n&&e.node[c]){e.node[nid].deserialize(o)}else{e.node[c]=new TreeNode(o,b);e.nnodes=b+1}}}}catch(p){}};e.init(d,false)}function TblHdrRow(c,g){var f=this;this.hdr=c.hdr;this.hcols=[];this.nc=g;this.getHeader=function(){return f.hdr};this.getColHeader=function(a){return f.hcols[a].getHeader()};this.setColHeader=function(a,b){f.hcols[a].setHeader(b)};this.getHeaderCol=function(a){return f.hcols[a]};this.addColumns=function(b){var d=f.nc;for(var a=0;a<b;a++){f.hcols[d+a]=cloneTblHdrCol(f.hcols[f.nc-1]);f.nc++}return b};this.delColumns=function(a){f.hcols.length-=a;f.nc-=a;return a};for(var h=0;h<g;h++){f.hcols[h]=createTblHdrCol(g>1?c.hcol[h]:c.hcol)}}function createTblRow(h,g,f){var e=new TblRow();e.init(h,g,f);return e}function cloneTblRow(d){var c=new TblRow();c.clone(d);return c}function TblRow(){var b=this;this.hdr=null;this.colhdrs=null;this.cols=[];this.nc=0;this.getHeader=function(){return b.hdr};this.setHeader=function(a){b.hdr=a};this.getCol=function(a){return b.cols[a]};this.addColumns=function(f){var a=b.nc;for(var c=0;c<f;c++){b.cols[a+c]=cloneTblCol(b.cols[b.nc-1]);b.nc++}return f};this.delColumns=function(a){b.cols.length-=a;b.nc-=a;return a};this.init=function(h,c,a){b.hdr=h.hdr;b.colhdrs=a;b.nc=c;for(var g=0;g<c;g++){b.cols[g]=createTblCol(c>1?h.cell[g]:h.cell,a.getHeaderCol(g))}};this.clone=function(a){b.hdr=a.hdr;b.colhdrs=a.colhdrs;b.nc=a.nc;for(var c=0;c<b.nc;c++){b.cols[c]=cloneTblCol(a.getCol(c))}};this.getType=function(a){return b.cols[a].getType()}}function createTblHdrCol(c){var d=new TblHdrCol();d.init(c);return d}function cloneTblHdrCol(d){var c=new TblHdrCol();c.clone(d);return c}function TblHdrCol(){var b=this;this.value=null;this.colfmt="";this.coltype="num";this.getHeader=function(){return b.value};this.setHeader=function(a){b.value=a};this.getColFmt=function(){return b.colfmt};this.getColType=function(){return b.coltype};this.init=function(a){var e=a.content==undefined&&a.colfmt==undefined&&a.coltype==undefined;b.value=a.content==undefined?(e?a:""):a.content;b.colfmt=a.colfmt==undefined?"":a.colfmt;b.coltype=a.coltype==undefined?"num":a.coltype};this.clone=function(a){b.value=a.value;b.colfmt=a.colfmt;b.coltype=a.coltype}}function createTblCol(f,d){var e=new TblCol();e.init(f,d);return e}function cloneTblCol(c){var d=new TblCol();d.clone(c);return d}function TblCol(){var b=this;this.editable=false;this.value=null;this.colhdr=null;this.isEditable=function(){return b.editable};this.getContent=function(){if(b.colhdr.getColType()=="num"){return b.value-0}return b.value};this.setContent=function(a){if(b.value!=a){b.value=a;return true}return false};this.init=function(d,a){b.editable=d.edit==undefined?false:d.edit;b.value=d.content==undefined?d:d.content;b.colhdr=a};this.clone=function(a){b.editable=a.editable;b.value=a.value;b.colhdr=a.colhdr};this.getType=function(){return b.colhdr.getColType()}}function processDataDescriptor(g){var e=null;try{e=jQuery.parseJSON(g)}catch(h){}var f=new modelObject(((e==null)?g:e));vc_app.setAppModel(f);vc_log.addToLog("Data descriptor loaded",false)}var timerObj=null;var timerObj1,timerObj2,timerObj3=null;var synctime=200;function processUIDescriptor(f){var e=jQuery.parseJSON(f);var d=new viewObject(((e==null)?f:e));vc_app.setAppView(d);vc_log.addToLog("UI descriptor loaded",false)}function processSessionData(g){var f=null;try{f=jQuery.parseJSON(g)}catch(h){}var e=(f==null)?g:f;vc_app.setAppSessionData(e);if(e==null){vc_log.addToLog("Loaded Session was empty",false)}else{vc_log.addToLog("Session loaded",false)}}function processUserData(g){var f=null;try{f=jQuery.parseJSON(g)}catch(h){}var e=(f==null)?g:f;vc_app.setAppUserData(e);if(e==null){vc_log.addToLog("Loaded user data object was empty",false)}else{vc_log.addToLog("User data loaded",false)}}function waitForViewAndSetUI(){if(vc_app.getAppView()!=null){if(timerObj){clearTimeout(timerObj);timerObj=null}vc_log.addToLog("Got the View object",false);waitForDataAndSetUI();return}else{vc_log.addToLog("adding vtimer",false)}timerObj=setTimeout("waitForViewAndSetUI ()",synctime)}function waitForDataAndSetUI(){if(vc_app.getAppModel()!=null){if(timerObj){clearTimeout(timerObj);timerObj=null}vc_log.addToLog("Got the Model object.",false);vc_app.getAppView().setCurPage(vc_app.curpageid);vc_app.getAppView().setModel(vc_app.getAppModel());waitForUserData();return}else{vc_log.addToLog("adding mtimer",false)}timerObj=setTimeout("waitForDataAndSetUI ()",synctime)}function waitForUserData(){if(vc_app.getAppUserData()!="loading"){if(timerObj){clearTimeout(timerObj);timerObj=null}if(vc_app.getAppGlobalData()!="ignore"&&vc_app.getAppGlobalData()!="loading"){vc_log.addToLog("Got the global data.",false);vc_app.getAppModel().deserialize(vc_app.getAppGlobalData(),false)}else{vc_log.addToLog("Ignoring getting global data",false)}if(vc_app.getAppUserData()!="ignore"){vc_log.addToLog("Got the user data object.",false);vc_app.getAppModel().deserialize(vc_app.getAppUserData(),false)}else{vc_log.addToLog("Ignoring getting User data",false)}waitForSessionData();return}else{vc_log.addToLog("adding utimer",false)}timerObj=setTimeout("waitForUserData ()",synctime)}function waitForSessionData(){if(vc_app.getAppSessionData()!="loading"){if(timerObj){clearTimeout(timerObj);timerObj=null}vc_log.addToLog("Got the session data object.",false);vc_app.getAppModel().deserialize(vc_app.getAppSessionData(),false);vc_app.getAppModel().recompute();vc_app.getAppView().createUI();vc_app.getAppView().refreshUI();return}else{vc_log.addToLog("adding stimer",false)}timerObj=setTimeout("waitForSessionData ()",synctime)}function appendUIMarkup(d,c){d.innerHTML+=c}function collapsePanel(h,j){var g=document.getElementById(h+"content");var f=document.getElementById(h+"acc_o");var k=document.getElementById(h+"acc_c");if(j){f.style.display="block";k.style.display="none";g.style.display="block"}else{k.style.display="block";f.style.display="none";g.style.display="none"}}function createDiv(g,e,f,h){return createElement(g,e,f,h,"div")}function createElement(j,g,h,l,m){var k=document.createElement(m);if(j.length>0){k.id=j}if(g.length>0){k.className=g}if(h.length>0){k.innerHTML=h}if(l!=null){l.appendChild(k)}return k}function viewObject(k){var h=this;this.model=null;this.panels=new Array();this.curPanel=null;this.autorecalc=k.view.autorecalc;this.uicreationcomplete=false;this.msoList=new Array();this.msoCtrl=null;this.getItem=function(a){return h.curPanel.getItem(a)};this.getItemAt=function(a){return h.curPanel.getItemAt(a)};this.getModel=function(){return h.model};this.getItemCount=function(){return h.curPanel.getItemCount()};this.setModel=function(a){h.model=a;h.initData(a)};this.setCurPage=function(a){if(a==null||a==""){return}else{h.curPanel=h.panels[a]}};this.createUI=function(){try{var a=document.getElementById("vcapp");h.curPanel.createUI(a);createDiv("helppopup","helppopupcover","",a);createDiv("htmlpopup","htmlpopupcover","",a);vc_log.setDbgMarkup();h.uicreationcomplete=true;vc_log.addToLog("UI creation complete",false)}catch(b){vc_log.addToLog("Error while creating UI:"+b,false)}};this.uiCreated=function(){return h.uicreationcomplete};this.hasErrors=function(){return h.curPanel.hasErrors()};this.checkValErrors=function(){return h.curPanel.checkValErrors()};this.getErrorStr=function(){return h.curPanel.getErrorStr()};this.resetErrors=function(){h.curPanel.resetErrors()};this.recalculate=function(a){if(h.hasErrors()){showPopError();return}else{hidePopError()}h.model.recompute(a);h.refreshUI()};this.serialize=function(){return h.model.serialize()};this.initData=function(e){for(var b in h.panels){if(b=="indexOf"){continue}h.panels[b].initData(e)}if(h.msoCtrl!=null){var c=h.msoCtrl;var d=c.getDataItem();var a=d.getCurValue();h.setMSO(c.isByRow()?d.getRowHeader(a):d.getColHeader(a))}};this.refreshUI=function(){if(h.uiCreated()){for(var a in h.panels){if(a=="indexOf"){continue}h.panels[a].refreshUI(h.model)}}};this.isAutoRecalc=function(){return h.autorecalc};this.findNavPanel=function(c){for(var a in h.panels){if(a=="indexOf"){continue}var b=h.panels[a].findNavPanel(c);if(b!=null){return b}}return null};this.setMSOCtrl=function(a){h.msoCtrl=a};this.addToMSOList=function(b){var a=b.getID();h.msoList[a]=b};this.setMSO=function(a){for(var c in h.msoList){if(c=="indexOf"){continue}var d=h.msoList[c];var b=d.getDataID();var e=d.getDataItem();e.setMultiSolveOutput((b==a),d.getMinVal(),d.getMaxVal())}};if(k.view.uipage!=undefined){var m=k.view.uipage[0]==undefined?1:k.view.uipage.length;var j;for(var g=0;g<m;g++){j=m==1?k.view.uipage:k.view.uipage[g];var l=new uipanelObject(j,this,true);h.panels[j.id]=l}h.curPanel=h.panels[j.id]}}function uipanelObject(x,p,y){var n=this;this.parent=p;this.isroot=y;this.uiitems=new Array();this.flatlist=new Array();this.id=y?"vcpage":x.id;this.elid=y?"vcpageel":x.elid;this.uiclass=y?"pagestyle":(typeof x.uiclass==="undefined"?"":x.uiclass);this.title=x.title?x.title:"";this.helppage=x.helppage?x.helppage:"";this.helppopup=x.helppopup?x.helppopup:"";this.heading=x.heading;this.autorecalc=false;this.tabbedcontainer=x.hyperdeck?x.hyperdeck=="yes":false;this.navpanel=null;this.muxcontainer=false;this.accordion=x.collapsible?(x.collapsible=="yes"||x.collapsible=="open"||x.collapsible=="closed"):false;this.accopen=this.accordion&&x.collapsible=="open";this.visSwitch=x.vswitchvar?x.vswitchvar:"";this.showcopy=n.isroot&&(x.showcopy?(x.showcopy=="yes"):true);this.getModel=function(){return n.parent.getModel()};this.getID=function(){return n.id};this.getElid=function(){return n.elid};this.getUIClass=function(){return n.uiclass};this.getClassString=function(){var a=n.uiclass;return a};this.isContainer=function(){return true};this.isTabbedContainer=function(){return n.tabbedcontainer};this.isMuxContainer=function(){return n.muxcontainer};this.setMuxContainer=function(a){n.muxcontainer=a};this.isCollapsible=function(){return n.accordion};this.hasErrors=function(){for(var a in n.uiitems){if(a=="indexOf"){continue}if(n.uiitems[a].hasErrors()){return true}}return false};this.checkValErrors=function(){for(var a in n.uiitems){if(a=="indexOf"){continue}if(n.uiitems[a].checkValErrors()){return true}}return false};this.getHelpPage=function(){return n.helppage};this.getHelpPopup=function(){return n.helppopup};this.getTitle=function(){return n.title};this.getHeading=function(){return n.heading};this.initData=function(b){for(var a in n.uiitems){if(a=="indexOf"){continue}n.uiitems[a].initData(b)}};this.refreshUI=function(c){for(var a in n.uiitems){if(a=="indexOf"){continue}n.uiitems[a].refreshUI(c)}var b=n.getModel().getItem(n.visSwitch);if(b){n.showPanel(b.getValue()!=0)}if(n.isTabbedContainer()){n.navpanel.refreshUI(c)}};this.createUI=function(f){var b=n.createPanelUI(f);if(n.isTabbedContainer()){n.navpanel.createUI(b)}for(var l in n.uiitems){if(l=="indexOf"){continue}var j=n.getItem(l);j.createUI(b)}n.createHelp();if(n.isTabbedContainer()){n.setCurrentPanel(n.navpanel.getCurPanelID())}else{if(n.isCollapsible()){var d=n.getID();collapsePanel(d,n.accopen)}}if(n.isroot){var g=new Date();var e=g.getYear()-0;if(e<=2000){e+=1900}if(n.showcopy){var h=createDiv("vcftr","vcftr","",b);var c=createDiv("vclegal","vclegal",'<a href="legal/terms.html" target="_blank">Disclaimer &amp; Legal Information</a>',h);var k=createDiv("vccopy","vccopy","&copy; "+e+", VisualCalc, Inc. All rights reserved.(v"+APPVERSION+")",h);var a=createDiv("vcftrend","vcftrend","",h)}}};this.getErrorStr=function(){var a="";for(var b in n.uiitems){if(b=="indexOf"){continue}a+=n.uiitems[b].getErrorStr()}return a};this.resetErrors=function(){for(var a in n.uiitems){if(a=="indexOf"){continue}n.uiitems[a].resetErrors()}};this.getItem=function(a){var b=n.uiitems[a];if(b==null){for(var c in n.uiitems){if(c=="indexOf"){continue}if(n.uiitems[c].isContainer()){b=n.uiitems[c].getItem(a);if(b){return b}}}}return b};this.getItemAt=function(a){return n.flatlist[a]};this.getFlatList=function(){return n.flatlist};this.getItemCount=function(){var a=n.uiitems.length;return a};this.createHelp=function(){n.createHelpPageLink();n.createHelpPopupLinks()};this.createHelpPageLink=function(){if(n.isroot){var a;if(document.getElementsByClassName){a=document.getElementsByClassName("helppage")}else{a=getElsByClassName("helppage")}var f=vc_app.getImageLoc()+"help.png";var g=vc_app.getImageLoc()+"help-hover.png";var b=vc_app.getHelpLoc();for(var c=a.length-1;c>=0;c--){var h=a[c].id;var d=Math.min(screen.width,screen.height)<768?420:600;var e='<div class="helplink"><a onmouseover=\'this.style.cursor="pointer";\' onfocus="this.blur();" onclick="window.open(\''+b+h+".html','vchelp','width="+d+',height=600,resizable=yes,scrollbars=yes,toolbar=no,location=no,directories=no,status=no,menubar=no,copyhistory=no\').focus()"><img src="'+f+'" onmouseover="this.src=\''+g+"'\" onmouseout=\"this.src='"+f+"'\" border=0></a></div>";a[c].innerHTML=e;a[c].style.zIndex="1"}}};this.createHelpPopupLinks=function(){if(n.isroot){var a;if(document.getElementsByClassName){a=document.getElementsByClassName("help")}else{a=getElsByClassName("help")}var d=vc_app.getImageLoc()+"help.png";var e=vc_app.getImageLoc()+"help-hover.png";for(var b=a.length-1;b>=0;b--){var c='<div class="helplink"><a onmouseover=\'this.style.cursor="pointer";\' onfocus="this.blur();" onclick="showHelpPopup(event, \''+a[b].getAttribute("id")+'\')"><img src="'+d+'" onmouseover="this.src=\''+e+"'\" onmouseout=\"this.src='"+d+"'\" border=0></a></div>";a[b].innerHTML=c;a[b].style.zIndex="1"}}};this.isAutoRecalc=function(){if(n.autorecalc){return n.autorecalc}return n.parent.isAutoRecalc()};this.createPanelUI=function(M){var h=n.getID();var g=n.getClassString();var I=n.getTitle();var l="panel";if(g.length>0){l=g}var J=createDiv(h,l,"",M);if(!n.isroot&&!n.isMuxContainer()){if(I.length>0){var c=n.getHeading();var b=(c)?"<h"+c+' class="'+l+'title">'+I+"</h"+c+">":I;var H=createDiv(h+"title",l+"title",n.isCollapsible()?"":b,J);var d=createDiv(h+"content",l+"content","",J);if(n.isCollapsible()){var G=createDiv(h+"accordion","accordion","",H);var m=vc_app.getImageLoc();var K=createDiv(h+"acc_o","accordion_o",'<a class="accordionlink" onmouseover="this.style.cursor=\'pointer\';" onfocus="this.blur();" onclick="collapsePanel( \''+h+'\', false )"><img class="accordionimage" src="'+m+'expanded.png" onmouseover="this.src=\''+m+"expanded-hover.png'\" onmouseout=\"this.src='"+m+"expanded.png'\" border=0>"+I+"</a>",G);var j=createDiv(h+"acc_c","accordion_c",'<a class="accordionlink" onmouseover="this.style.cursor=\'pointer\';" onfocus="this.blur();" onclick="collapsePanel( \''+h+'\', true )"><img class="accordionimage" src="'+m+'collapsed.png" onmouseover="this.src=\''+m+"collapsed-hover.png'\" onmouseout=\"this.src='"+m+"collapsed.png'\" border=0>"+I+"</a>",G);createDiv("","accordionend","",H)}var L=n.getHelpPage();if(L.length>0){var f=createDiv(L,"helppage","&nbsp;",H);var a=createDiv("debugcover","debugcover","",H)}var k=n.getHelpPopup();if(k.length>0){var e=createDiv(k,"help","&nbsp;",H)}return d}}return J};this.setCurrentPanel=function(c){if(n.isTabbedContainer()){for(var b in n.uiitems){if(b=="indexOf"){continue}var a=n.uiitems[b];if(a.getID()==c){a.showPanel(true)}else{if(a.isContainer()){a.showPanel(false)}}}}};this.showPanel=function(a){var c=n.getID();var b=document.getElementById(c);if(b){b.style.display=a?"block":"none"}};this.findNavPanel=function(c){if(n.isTabbedContainer()){if(n.navpanel.getID()==c){return n.navpanel}}else{for(var a in n.uiitems){if(a=="indexOf"){continue}if(n.uiitems[a].isContainer()){var b=n.uiitems[a].findNavPanel(c);if(b!=null){return b}}}}return null};this.setMSOCtrl=function(a){n.parent.setMSOCtrl(a)};this.addToMSOList=function(a){n.parent.addToMSOList(a)};var q="";if(x.uiitem!=undefined){var v=x.uiitem[0]==undefined?1:x.uiitem.length;for(var r=0;r<v;r++){var t=v==1?x.uiitem:x.uiitem[r];var o=new uiItem(t,this);n.uiitems[t.id]=o;if(vc_log.isDebugMode()){q+=t.id+";"}}}if(x.uipanel!=undefined){var w=x.uipanel[0]==undefined?1:x.uipanel.length;for(var r=0;r<w;r++){var s=w==1?x.uipanel:x.uipanel[r];var u=new uipanelObject(s,this,false);if(n.isTabbedContainer()){u.setMuxContainer(true)}n.uiitems[s.id]=u;if(vc_log.isDebugMode()){q+=s.id+";"}}}if(n.isTabbedContainer()){n.navpanel=new navpanelObject(x.navpanel,this,n.uiitems)}vc_log.addToLog(q,false);n.autorecalc=x.autorecalc==undefined?false:x.autorecalc}function navpanelObject(l,m,j){var k=this;this.parent=m;this.navitems=new Array();this.id=l.id;this.elid=l.elid;this.cls=l.uiclass?l.uiclass:"";this.curpid=l.defpanel;this.npanels=0;this.dataid=l.dataid?l.dataid:null;this.getID=function(){return k.id};this.createUI=function(c){if(k.dataid==null){var a='<div id="'+k.id+'" class="'+k.cls+'">';for(var b=0;b<k.npanels;b++){var e=k.id+"_"+b;var d=' class="'+k.navitems[b].getClassName(k.cls)+'"';a+='<div id="'+e+'"'+d+">"+k.navitems[b].getPanelUIStr(k.id)+"</div>"}a+="</div>";appendUIMarkup(c,a)}};this.refreshUI=function(b){if(k.dataid!=null){var a=b.getItem(k.dataid);var c=a.getCurValue();k.setCurrentPanel(k.navitems[c])}};this.getCurPanelID=function(){return k.curpid};this.setCurrentPanel=function(a){k.curpid=a;k.updateNavItems(a);k.parent.setCurrentPanel(a)};this.updateNavItems=function(c){if(k.dataid==null){for(var b=0;b<k.npanels;b++){var d=c==k.navitems[b].getPanelID()?true:false;var e=k.navitems[b].isPanelOn();k.navitems[b].setIsOn(d);var a=document.getElementById(k.id+"_"+b);k.replaceCls(a,e,d)}}};this.replaceCls=function(b,f,d){if(k.dataid==null&&b&&f!=d){var c=(k.cls?k.cls:"");var a=c+k.navitems[0].getOnOffStr(f);var e=c+k.navitems[0].getOnOffStr(d);b.className=e}};this.setMSOCtrl=function(a){k.parent.setMSOCtrl(a)};this.addToMSOList=function(a){k.parent.addToMSOList(a)};var q=0;for(var p in j){if(p=="indexOf"){continue}var o=j[p];if(o.isContainer()){var n=k.curpid==o.id;if(k.dataid==null){k.navitems[q]=new navItem(q,o,n)}else{k.navitems[q]=o.getID()}q++}}k.npanels=q}function navItem(e,h,g){var f=this;this.ordinal=e;this.panel=h;this.ishi=g;this.setIsOn=function(a){f.ishi=a};this.isPanelOn=function(){return f.ishi};this.getPanelTitle=function(){return f.panel.getTitle()};this.getPanelID=function(){return f.panel.getID()};this.getPanelUIStr=function(a){var b="javascript:vc_app.navPanelClicked('"+a+"', '"+f.panel.id+"')";return'<a href="'+b+'">'+f.getPanelTitle()+"</a>"};this.getClassName=function(a){return a+f.getOnOffStr(f.ishi)};this.getOnOffStr=function(a){return a?"_on":"_off"}}function uiItem(o,p){var self=this;this.o=o;this.id=o.id;this.dataid=o.dataid;this.parpanel=p;this.valcb=null;this.error=false;this.errorstr="";this.errsubel="";this.byrow="no";this.addhelp="yes";this.minvals=null;this.maxvals=null;this.incvals=null;this.defvals=null;this.dtypes=null;this.dfmts=null;this.uitypes=null;this.uiclasses=null;this.edits=null;this.hiddenrc=null;this.ridx=-1;this.cidx=-1;this.nr=1;this.nc=1;this.maxlen=o.maxlen?o.maxlen:80;this.src=o.src;this.size=o.size;this.msitem=(o.msolv?o.msolv:"no")=="yes"?true:false;this.emptyval=o.emptyval?o.emptyval:"0";this.placeholder=o.placeholder?o.placeholder:"";this.hasshowrange=(o.showrange?o.showrange:"no")=="yes"?true:false;this.allownovalue=(o.allownovalue?o.allownovalue:"no")=="yes"?true:false;this.htmlpopup=o.htmlpopup?o.htmlpopup:"";this.panelpopup=o.panelpopup?o.panelpopup:"";this.ismodalpopup=(o.modalpopup?o.modalpopup:"no")=="yes"?true:false;this.getModel=function(){return self.parpanel.getModel()};this.getID=function(){return self.o.id};this.isByRow=function(){return self.byrow=="yes"};this.getElid=function(){return self.o.elid};this.isContainer=function(){return false};this.getPlaceholder=function(){return self.placeholder};this.hasShowRange=function(){return self.hasshowrange};this.allowNoValue=function(){return self.allownovalue};this.getHtmlPopup=function(){return self.htmlpopup};this.getPanelPopup=function(){return self.panelpopup};this.isModalPopup=function(){return self.ismodalpopup};this.hasErrors=function(){return self.error?true:false};this.setErrorStr=function(s){self.errorstr=s};this.getErrorStr=function(){return self.error?(self.errorstr+"<br/>"):""};this.checkValErrors=function(){if(self.isUICollection()){for(var r=0;r<ditem.getNumRows();r++){for(var c=0;c<ditem.getNumCols();c++){if(self.getCellUIType(r,c)=="select"){if(self.validateSelectionCell(r,c)){return true}}}}}else{if(self.getUIType()=="select"){return self.validateSelection()}}return false};this.getTitle=function(){return self.getUILabel()};this.getMaxLen=function(){if(self.maxlen==undefined||self.maxlen<1){return 80}return self.maxlen};this.getSize=function(){return self.size};this.initData=function(m){var ditem=m.getItem(self.dataid);if(ditem){if(self.defvals!=""){if(self.isUICollection()){ditem.setDefValues(self.byrow,self.defvals)}else{if(ditem.isVector()){ditem.setDefValue(self.defvals)}else{var val=self.getDefVal();if(val.length!=0){ditem.setDefValue(val)}}}}}};this.refreshUI=function(m){var ditem=m.getItem(self.dataid);if(ditem){if(self.isMultiSolveItem()&&ditem.isMultiSolveItem()){var el=document.getElementById(self.getID());if(el){if(ditem.isMultiSolveOutput()){el.style.display="none";return}else{el.style.display="block"}}else{return}}if(ditem.isVector()){if(self.isUICollection()){var nr=ditem.getNumRows();var nc=ditem.getNumCols();var otype=self.getUIType();if(otype=="inptable"){self.reCreateInputTable(nr,nc)}for(var r=0;r<nr;r++){for(var c=0;c<nc;c++){self.setDataIntoUI(ditem.getCellValue(r,c),false,true,r,c)}}}else{var r=self.getDataIndexRow(),c=self.getDataIndexCol();var v=(r>=0&&c>=0)?ditem.getCellValue(r,c):ditem.getCurValue();self.setDataIntoUI(v,false,false,r,c)}}else{self.setDataIntoUI(ditem.getValue(),false,false,0,0)}}else{if(self.isDynamicElement()){self.setDataIntoUI(null,false,false,0,0)}}};this.isDynamicElement=function(){var x=self.getUIType();return(x=="embdynamic")};this.isMultiSolveItem=function(){return self.msitem};this.isMultiSolveCtrl=function(){return(self.getUIType()=="msolselect")};this.createUI=function(parentdiv){var otype=self.getUIType();if(otype=="input"){self.createAnInput(parentdiv)}else{if(otype=="select"){self.createASelectionList(parentdiv,"valuesintbl",false)}else{if(otype=="vselect"||otype=="msolselect"){self.createASelectionList(parentdiv,"valuesinhdr",otype=="msolselect")}else{if(otype=="div"){self.createAnElement(parentdiv)}else{if(otype=="slider"){self.createASlider(parentdiv)}else{if(otype=="sliderwinput"){self.createASliderWInput(parentdiv)}else{if(otype=="button"||otype=="link"||otype=="imglink"){self.createALink(parentdiv,otype)}else{if(otype=="static"){self.createAStaticItem(parentdiv,"lv")}else{if(otype=="embstatic"){self.createAStaticItem(parentdiv,"em")}else{if(otype=="embdynamic"){self.createAStaticItem(parentdiv,"dy")}else{if(otype=="inptable"){self.createInputTable(parentdiv,true)}else{if(otype=="graph"||otype=="image"){self.createAGraph(parentdiv,otype=="graph")}else{if(otype=="checkbox"){self.createCheckBoxes(parentdiv,false)}else{if(otype=="checkboxlabfirst"){self.createCheckBoxes(parentdiv,true)}else{if(otype=="switchpanel"){self.displayPanels()}else{if(otype=="radiogrp"){self.createARadioGroup(parentdiv)}else{if(otype=="erroritem"){self.createErrorItem(parentdiv)}else{if(otype=="tree"){self.createTreeItem(parentdiv)}}}}}}}}}}}}}}}}}}try{var vcb="val_"+self.getID();if(eval(vcb)!=undefined){self.valcb=vcb}}catch(er){}};this.resetErrors=function(){self.setError(false)};this.isUICollection=function(){var iscoll=self.o.uitype=="inptable";return iscoll};this.getUIType=function(){return self.o.uitype};this.getUIClass=function(){return self.o.uiclass};this.getCellUIType=function(r,c){var i=(self.isByRow())?r:c;var t=self.o.uitype;try{t=self.uitypes[i]}catch(err){t=self.o.uitype}return t};this.getCellUIClass=function(r,c){var i=(self.isByRow())?r:c;var cl=self.o.uiclass;try{cl=self.uiclasses[i]}catch(err){cl=self.o.uiclass}return cl};this.isEditable=function(r,c){var i=(self.isByRow())?r:c;var e=self.o.edit;try{e=self.edits[i]}catch(err){e=self.o.edit}return(e=="yes")};this.isColHidden=function(c){if(self.hiddenrc&&self.hiddenrc.length>0){return self.hiddenrc[c]=="0"}return false};this.getMinVal=function(){return self.getCellUIEntity("minv",0,0)};this.getMaxVal=function(){return self.getCellUIEntity("maxv",0,0)};this.getIncVal=function(){return self.getCellUIEntity("incv",0,0)};this.getDefVal=function(){return self.getCellUIEntity("defv",0,0)};this.getDataType=function(){return self.getCellUIEntity("dtyp",0,0)};this.getDataFmt=function(){return self.getCellUIEntity("dfmt",0,0)};this.getMinVal=function(r,c){return self.getCellUIEntity("minv",r,c)};this.getMaxVal=function(r,c){return self.getCellUIEntity("maxv",r,c)};this.getIncVal=function(r,c){return self.getCellUIEntity("incv",r,c)};this.getDefVal=function(r,c){return self.getCellUIEntity("defv",r,c)};this.getDataType=function(r,c){return self.getCellUIEntity("dtyp",r,c)};this.getDType=function(r,c){var d=self.getDataItem();if(d){if(r<0||c<0){return d.getDataType()}else{return d.getCellDataType(r,c)}}return""};this.getDataFmt=function(r,c){return self.getCellUIEntity("dfmt",r,c)};this.getdefined=function(x,y){if(x==undefined){return y}else{return x}};this.getCellUIEntity=function(entity,r,c){var i=(self.isByRow())?r:c;var typ=(self.dtypes[i]!=undefined)?self.dtypes[i]:((self.dtypes[0]!=undefined)?self.dtypes[0]:self.dtypes);if(typ==""){typ=self.getDType(r,c)}var v,def;if(entity=="minv"){def=((self.minvals[0]!=undefined)?self.minvals[0]:self.minvals)}else{if(entity=="maxv"){def=((self.maxvals[0]!=undefined)?self.maxvals[0]:self.maxvals)}else{if(entity=="incv"){def=((self.incvals[0]!=undefined)?self.incvals[0]:self.incvals)}else{if(entity=="defv"){def=((self.defvals[0]!=undefined)?self.defvals[0]:self.defvals)}else{if(entity=="dtyp"){def=(self.dtypes[0]!=undefined)?self.dtypes[0]:self.dtypes;if(def==""||def==undefined){def=typ}}else{if(entity=="dfmt"){def=(self.dfmts[0]!=undefined)?self.dfmts[0]:self.dfmts}else{def=""}}}}}}try{if(entity=="minv"){v=(self.minvals[i]!=undefined)?self.minvals[i]:def;if(typ=="num"){v=v-0}}else{if(entity=="maxv"){v=(self.maxvals[i]!=undefined)?self.maxvals[i]:def;if(typ=="num"){v=v-0}}else{if(entity=="incv"){v=(self.incvals[i]!=undefined)?self.incvals[i]:def;if(typ=="num"){v=v-0}}else{if(entity=="defv"){v=(self.defvals[i]!=undefined)?self.defvals[i]:def;if(typ=="num"){if(v.length!=0){v=v-0}}}else{if(entity=="dtyp"){if(self.dtypes[i]==""){v=def}else{v=self.dtypes[i]}}else{if(entity=="dfmt"){if(typ=="str"){v=(self.dfmts[i]!=undefined)?self.dfmts[i]:"*"}else{v=(self.dfmts[i]!=undefined)?self.dfmts[i]:def}}else{v=""}}}}}}}catch(err){v=def}return v};this.getUILabel=function(){return self.o.uilabel};this.getAltLabel=function(){var al=self.o.alt;if(al==undefined){al=""}return al};this.getMinMaxStr=function(){var d=self.getDataItem();var s=self.getMinVal()+":"+self.getMaxVal()+":"+self.getIncVal()+":"+(d.isDiscrete()?"map":"nomap");return s};this.getDataID=function(){return self.dataid};this.getDataValue=function(){return self.getDataItem().getValue()};this.getDataItem=function(){return self.getDataItemFromID(self.dataid)};this.getDataItemFromID=function(did){var m=self.getModel();return m.getItem(did)};this.getDataIndexRow=function(){return self.ridx};this.getDataIndexCol=function(){return self.cidx};this.getSectionID=function(){return self.o.secid};this.getHRef=function(){return self.o.href};this.getLinkSrc=function(){return self.o.src};this.getValidationCB=function(){return self.valcb};this.getActionData=function(){var d=self.o.actiondata;if(d==undefined){return""}return d};this.displayPanels=function(){var usedata=(self.o.switchwith=="data");var ditem=self.getDataItem(self.dataid);var onpnlidx=(usedata)?ditem.getValue():self.o.defpanel;var pnlids=self.o.swpanels.split(",");switchThePanel(pnlids,onpnlidx)};this.appendCoverMarkup=function(parentdiv,mkup){return self.processCoverMarkup(parentdiv,mkup,true)};this.processCoverMarkup=function(parentdiv,mkup,append){var coverdiv=document.createElement("div");coverdiv.id=self.getID();coverdiv.className=self.getUIClass()+"cover";var oldcoverdiv=document.getElementById(self.getID());if(!append&&oldcoverdiv){parentdiv.replaceChild(coverdiv,oldcoverdiv)}else{parentdiv.appendChild(coverdiv)}appendUIMarkup(coverdiv,mkup);return coverdiv};this.reCreateInputTable=function(r,c){var coverdiv=document.getElementById(self.getID());if(coverdiv){if(self.nr==r&&self.nc==c){return}self.createInputTable(coverdiv.parentNode,false)}};this.createCheckBoxes=function(parentdiv,labfirst){var ditem=self.getDataItem();var vec=ditem.isVector();var nboxes=vec?ditem.getNumRows()*ditem.getNumCols():1;var cls=self.getUIClass();var elid=self.getElid();var mkup="";for(var b=0;b<nboxes;b++){var uiid=elid+"_"+b;var boxlab=vec?ditem.getRowHeader(b):self.getUILabel();var chkd=(vec?ditem.getCellValue(b,0):ditem.getCurValue())!=0?" checked":"";var lab='<div class="'+cls+'lab"><label for="'+uiid+'">'+boxlab+"</label></div>";if(labfirst){mkup+=lab}mkup+='<input type="checkbox" id="'+uiid+'" name="'+elid;mkup+='" class="'+cls+'_cb" onClick="boxClicked ( \''+self.getID()+"', "+b+' )"'+chkd+">";if(!labfirst){mkup+=lab}}mkup+='<div class="'+cls+'end"></div>';self.appendCoverMarkup(parentdiv,mkup)};this.createARadioGroup=function(parentdiv,loc){var lab=self.getUILabel();var uiclass=self.getUIClass();var mkup="";if(lab.length>0){mkup+='<div class="'+uiclass+'lab">'+lab+"</div>"}var ditem=self.getDataItem();var vec=ditem.isVector();var nboxes=vec?ditem.getNumRows():1;if(nboxes>0){var elid=self.getElid();mkup+='<div class="'+uiclass+'vals">';for(var b=0;b<nboxes;b++){mkup+='<div class="'+uiclass+'val">';var uiid=elid+"_"+b+"_0";var boxlab=vec?ditem.getRowHeader(b):self.getUILabel();var chkd=ditem.getCurValue()==b?" checked":"";var l='<div class="'+uiclass+'item"><label for="'+uiid+'">'+boxlab+"</label></div>";if(loc==undefined){loc="rlab"}if(loc=="llab"){mkup+=l}mkup+='<input type="radio" id="'+uiid+'" name="'+elid+'" class="'+uiclass+'button" onClick="radioClicked ( \''+self.getID()+"', "+b+' )"'+chkd+">";if(loc!="llab"){mkup+=l}mkup+="</div>"}mkup+="</div>"}mkup+='<div class="'+uiclass+'end"></div>';self.appendCoverMarkup(parentdiv,mkup)};this.createErrorItem=function(parentdiv){var uiclass=self.getUIClass();var elid=self.getElid();var imgloc=vc_app.getImageLoc();var mkup='<div class="'+uiclass+'icon"><img src="'+imgloc+'error.png" border="0"></div><div class="'+uiclass+'title">Please correct the following errors:</div><div id="'+elid+'" class="'+uiclass+'"></div><div class="'+uiclass+'end"></div>';self.appendCoverMarkup(parentdiv,mkup);hidePopError()};this.createInputTable=function(parentdiv,append){var ditem=self.getDataItem();var istbl=ditem.isVector();if(istbl){var cover=self.processCoverMarkup(parentdiv,"",append);var nr=ditem.getNumRows();var nc=ditem.getNumCols();var cls=self.getUIClass();var tbl=createElement("",cls,"",cover,"table");tbl.style.borderCollapse="collapse";var hashdrrow=ditem.hasHdrRow();var v=ditem.getCornerHeader();var tr=null;if(hashdrrow){var thd=createElement("",cls+"head","",tbl,"thead");tr=createElement("","","",thd,"tr");createElement("",cls+"topleft",v,tr,"th");for(var c=0;c<nc;c++){var oddevencol=((c&1)==0?"0":"1");var topright=((c+1)==nc?"tr":"");if(!self.isColHidden(c)){v=ditem.getColHeader(c);var th=createElement("",cls+topright+"c"+oddevencol+"hdr","",tr,"th");if(self.byrow=="no"&&self.addhelp=="yes"){createElement(h_self.getID()+c,"help","",th,"div")}createElement("",cls+topright+"c"+oddevencol+"hdrval",v,th,"div")}}}var tbdy=createElement("",cls+"body","",tbl,"tbody");for(var r=0;r<nr;r++){var rh=ditem.getRowHeader(r);var oddevenrow=((r&1)==0?"0":"1");var bottomleft=(r+1)==nr?"bl":"";tr=createElement("","","",tbdy,"tr");createElement("",cls+bottomleft+"r"+oddevenrow+"hdr",rh+"",tr,"th");for(var c=0;c<nc;c++){var oddevencol=((c&1)==0?"0":"1");var bottomright=((r+1)==nr)&&((c+1)==nc)?"br":"";if(self.isColHidden(c)){continue}var celid=self.getElid()+"_"+r+"_"+c;fv=formatit(ditem.getCellValue(r,c),self.getDataFmt(r,c));if(!self.isEditable(r,c)){v=fv;createElement(celid,cls+bottomright+"r"+oddevenrow+"c"+oddevencol,v,tr,"td")}else{var otype=self.getCellUIType(r,c);if(otype=="optin"){var chk=(ditem.getCellValue(r,c)!=0)?" checked":"";v='<input type="checkbox" value="1" onClick="cellChecked ( \''+self.getID()+"',"+r+","+c+' )" id="'+celid+'"'+chk+">";createElement("",cls+bottomright+"r"+oddevenrow+"c"+oddevencol,v,tr,"td")}else{v=""}if(otype=="input"||otype=="inptable"){var tc=createElement("",cls+bottomright+"r"+oddevenrow+"c"+oddevencol,v,tr,"td");var cinp=createElement(celid,cls+"input","",tc,"input");cinp.type="text";cinp.name="";cinp.value=fv;self.hookValueChgHandlers(cinp)}}}}self.nr=nr;self.nc=nc}};this.handleValueChange=function(evt,elid,r,c){var h_enter=evt.type=="keydown"&&evt.keyCode===13;var h_blur=evt.type=="blur";if(h_blur){var newval=null;if(r<0||c<0){r=self.getDataIndexRow();c=self.getDataIndexCol();newval=self.getValueFromUI();if(newval===""){newval=self.getDataValue();self.setDataIntoUI(newval,false,false,0,0)}}else{newval=self.getCellValueFromUI(r,c);if(newval===""){var ditem=self.getDataItem();newval=ditem.getCellValue(r,c);self.setDataIntoUI(newval,false,true,r,c)}}var vec=false;if(self.isUICollection()||(r>=0&&c>=0)){vec=true}else{r=0;c=0}if(self.validateCell(elid,newval,r,c,false)){self.updateData(newval,vec,r,c)}else{evt.stopPropagation?evt.stopPropagation():evt.cancelBubble=true;return false}}else{if(h_enter){var tgt=evt.target?evt.target:evt.srcElement;tgt.blur()}}return true};this.createTreeItem=function(parentdiv){var ditem=self.getDataItem();var istree=ditem.isTree();if(istree){self.createNode(ditem,parentdiv,0);self.appendCoverMarkup(parentdiv,"")}};this.createNode=function(o,pd,lev){var tdiv=createDiv(self.getID()+o.getID(),self.getUIClass()+lev,o.getName(),pd);if(o.getNumNodes()>0){for(i in o.getNodes()){if(i=="indexOf"){continue}var node=o.findNode(i);self.createNode(node,tdiv,lev-0+1)}}};this.createAStaticItem=function(parentdiv,ty){var r=self.getDataIndexRow();var c=self.getDataIndexCol();var uilabel=self.getUILabel();var mkup=null;var elid=self.getElid();var uiclass=self.getUIClass();if(ty=="lv"){var item=self.getDataItem();var value=item==null?(""):((r<0||c<0)?item.getValue():item.getCellValue(r,c));value=formatit(value,self.getDataFmt());mkup='<div class="'+uiclass+'lab">'+self.markUpLabel(self.getUILabel())+'</div><div id="'+elid+'" class="'+uiclass+'val">'+value+"</div>"}else{if(ty=="em"){var item=self.getDataItem();var value=item==null?(""):((r<0||c<0)?item.getValue():item.getCellValue(r,c));value=formatit(value,self.getDataFmt());var label=uilabel.replace("{data}",value);mkup='<div id="'+elid+'" class="'+uiclass+'lab">'+label+"</div>"}else{if(ty=="dy"){var label=self.replaceRefs(uilabel);mkup='<div id="'+elid+'" class="'+uiclass+'lab">'+label+"</div>"}}}mkup+='<div class="'+uiclass+'end"></div>';self.appendCoverMarkup(parentdiv,mkup)};this.replaceRefs=function(uilabel){try{if(uilabel.indexOf("{")<0){return uilabel}}catch(err){return uilabel}var label="";var loc=0;while(loc>=0){var vstart=uilabel.indexOf("{",loc);if(vstart>=loc){label+=uilabel.substr(loc,vstart-loc);loc=vstart+1;var vend=uilabel.indexOf("}",loc);var dblderef=false;if(vend>=loc){var did=uilabel.substr(loc,vend-loc);if(did.charAt(0)=="@"){did=did.substr(1);dblderef=true}var item=self.getDataItemFromID(did);var fmt=item.getDefFmt();var value=item==null?("{"+did+"}"):self.replaceRefs(dblderef?item.getValueAtCursor():formatit(item.getValue(),fmt));label+=value;loc=vend+1;if(loc>=uilabel.length){loc=-1}}else{label+=uilabel.substr(vstart);loc=-1}}else{label+=uilabel.substr(loc);loc=-1}}return label};this.createALink=function(parentdiv,otype){var href=self.getHRef();var clikparms=self.getLinkParms(href);var mkup=null;if(otype=="link"){mkup='<a class="'+self.getUIClass()+'lnk" href="'+clikparms+'">'+self.getUILabel()+"</a>"}else{if(otype=="button"){mkup='<input type="button" value="'+self.getUILabel()+'" class="'+self.getUIClass()+'" onClick="'+clikparms+'" name="'+self.getElid()+'">'}else{if(otype=="imglink"){mkup='<input type="image" src="'+self.getLinkSrc()+'" class="'+self.getUIClass()+'" onClick="'+clikparms+'" name="'+self.getElid()+'">'}}}self.appendCoverMarkup(parentdiv,mkup)};this.getLinkParms=function(href){var tokens=href.split(":");var nt=tokens.length;var clikparms=null;if(nt==1){clikparms="javascript:handleBtnClick('"+href+"')"}else{if(nt>1&&tokens[0]=="aa"){var actionparms=self.getActionData();clikparms="javascript:handleAction('"+tokens[1]+"', '"+actionparms+"')"}else{if(nt>1&&tokens[0]=="js"){clikparms="javascript:callJSFunction('"+tokens[1]+"()')"}else{if(nt>1&&tokens[0]=="ma"){clikparms="javascript:showPanelPopup('"+tokens[1]+"', true)"}else{if(nt>1&&tokens[0]=="mu"){clikparms="javascript:showHtmlPopup('"+tokens[1]+"', true)"}else{if(nt>1&&tokens[0]=="pa"){clikparms="javascript:showPanelPopup('"+tokens[1]+"', false)"}else{if(nt>1&&tokens[0]=="pu"){clikparms="javascript:showHtmlPopup('"+tokens[1]+"', false)"}else{clikparms=href}}}}}}}return clikparms};this.getInputAltLabel=function(){var al=self.getAltLabel();if(al.length==0){al="&nbsp;enter a value between "+formatit(self.getMinVal(),self.getDataFmt())+" and "+formatit(self.getMaxVal(),self.getDataFmt())}var txt='<span class="altlabel">'+al+"</span>";return txt};this.markUpLabel=function(label){var mkup="";if(label.length>0){var parms=null;var altlab=self.getInputAltLabel();var panelpopup=self.getPanelPopup();var htmlpopup=self.getHtmlPopup();if(panelpopup.length>0||htmlpopup.length>0){if(panelpopup.length>0){if(self.isModalPopup()){parms=self.getLinkParms("ma:"+panelpopup)}else{parms=self.getLinkParms("pa:"+panelpopup)}}else{if(self.isModalPopup()){parms=self.getLinkParms("mu:"+htmlpopup)}else{parms=self.getLinkParms("pu:"+htmlpopup)}}}else{var href=self.getHRef();if(href){parms=self.getLinkParms(href)}}if(parms){mkup='<a onmouseover="this.style.cursor=\'pointer\';" onfocus="this.blur();" onclick="'+parms+'">'+label+altlab+"</a>"}else{mkup=label+altlab}}return mkup};this.createAnInput=function(parentdiv){var value=formatit(self.getDataItem().getValue(),self.getDataFmt());var lab=self.getUILabel();var cls=self.getUIClass();var uiid=self.getElid();var placeholder=self.getPlaceholder();if(self.hasShowRange()){var minv=self.getMinVal();var maxv=self.getMaxVal();var fmt=self.getDataFmt();var mn=formatit(minv,fmt);var mx=formatit(maxv,fmt);placeholder=mn+" - "+mx}if(self.allowNoValue()){value=self.getDefVal();if(value==""){self.updateData(null,false,0,0)}else{self.updateData(value,false,0,0);value=formatit(value,self.getDataFmt())}}var cover=self.appendCoverMarkup(parentdiv,"");if(lab.length>0){createElement("",cls+"lab",'<label for="'+uiid+'">'+self.markUpLabel(lab)+"</label>",cover,"div")}var valel=createElement("",cls+"val","",cover,"div");var cinp=createElement(uiid,cls,"",valel,"input");cinp.name=uiid;cinp.value=value;cinp.placeholder=placeholder.length>0?placeholder:"";createElement("",cls+"end","",cover,"div");self.hookValueChgHandlers(cinp)};this.valueChanged=function(e){var evt=e?e:event;var tgt=evt.target?evt.target:evt.srcElement;var elid=tgt?tgt.id:self.getElid();var r=-1,c=-1;var val=self.handleValueChange(evt,elid,r,c);if(!val){showPopError();window.setTimeout(function(){self.selectContents(elid)},50);return false}return true};this.cellValueChanged=function(e){var evt=e?e:event;var tgt=evt.target?evt.target:evt.srcElement;var elid=tgt?tgt.id:self.getElid();var rc=elid.split("_");var r=rc[rc.length-2]-0,c=rc[rc.length-1]-0;var val=self.handleValueChange(evt,elid,r,c);if(val){var x=elid}else{showPopError();window.setTimeout(function(){self.selectContents(elid)},50);return false}return true};this.hookValueChgHandlers=function(inpel){var cell=self.isUICollection();addEventHandler(inpel,"keydown",cell?self.cellValueChanged:self.valueChanged);addEventHandler(inpel,"blur",cell?self.cellValueChanged:self.valueChanged)};this.unhookValueChgHandlers=function(inpel){var cell=self.isUICollection();removeEventHandler(inpel,"keydown",cell?self.cellValueChanged:self.valueChanged);removeEventHandler(inpel,"blur",cell?self.cellValueChanged:self.valueChanged)};this.createASelectionList=function(parentdiv,mode,msol){var uiclass=self.getUIClass();var ditem=self.getDataItem();var idx=ditem.getCurValue();var vsel=mode=="valuesinhdr";var byrow=ditem.getNumRows()>1;var num=vsel?(ditem.getNumRows()*ditem.getNumCols()):(byrow?ditem.getNumRows():ditem.getNumCols());var options=new Array(num);var selhdlr=msol?"msolValueChanged":"selectValueChanged";for(var i=0;i<num;i++){var txt=(i==idx)?" selected":"";var hdr=vsel?(byrow?ditem.getCellValue(i,0):ditem.getCellValue(0,i)):(byrow?ditem.getCellValue(i,1):ditem.getCellValue(1,i));if(hdr==""){hdr="Option "+i}var oval=vsel?(byrow?ditem.getRowHeader(i):ditem.getColHeader(i)):(byrow?ditem.getCellValue(i,0):ditem.getCellValue(0,i));if(oval==""){oval=i}options[i]='<option value="'+oval+'"'+txt+">"+hdr+"</option>"}var optstr=options.join("\n");var uiid=self.getElid();var mkup='<div class="'+uiclass+'lab"><label for="'+uiid+'">'+self.getUILabel()+'</label></div><div class="'+uiclass+'"><select id="'+uiid+'" name="'+uiid+'" size="1" class="'+uiclass+'item" onChange="'+selhdlr+" ( '"+self.getID()+"' );\">"+optstr+'</select></div><div class="'+uiclass+'end"></div>';self.appendCoverMarkup(parentdiv,mkup);var el=document.getElementById(self.getElid());if(el){el.selectedIndex=idx}};this.createAnElement=function(parentdiv){};this.createAGraph=function(parentdiv,dyn){var imgsrc=dyn?self.getDataItem().getValue():self.src;var isz="";var alttxt=self.getAltLabel();try{var sizes=self.getSize().split("x");isz=' width="'+sizes[0]+'" height="'+sizes[1]+'"'}catch(error){isz=""}var mkup="";mkup='<img src="'+imgsrc+'" id="'+self.getElid()+'" border="0"'+isz+' alt="'+alttxt+'">';self.appendCoverMarkup(parentdiv,mkup)};this.createASlider=function(parentdiv){var uiclass=self.getUIClass();var mkup='<dl class="'+uiclass+'_dl" id="sl'+self.getElid()+'">';mkup+='<dt class="'+uiclass+'_dt">'+self.getUILabel()+"</dt>";mkup+='<dd class="'+uiclass+'rng" id="st'+self.getElid()+'"></dd>';mkup+='<dd class="'+uiclass+'cntrl">';mkup+='<div class="'+uiclass+'decr"></div>';mkup+='<div class="'+uiclass+'bar6" title="Click to move here"></div>';mkup+='<div class="'+uiclass+'incr"></div>';mkup+='<div class="'+uiclass+'sldr" title="'+self.markUpLabel(self.getUILabel())+'"></div>';mkup+="</dd>";mkup+='<dd class="'+uiclass+'labs">';mkup+='<div class="'+uiclass+'labmin">'+formatit(self.getMinVal(),self.getDataFmt())+"</div>";mkup+='<div class="'+uiclass+'labmax">'+formatit(self.getMaxVal(),self.getDataFmt())+"</div>";mkup+="</dd>";mkup+="</dl>";mkup+='<div class="'+uiclass+'1end"></div>';self.appendCoverMarkup(parentdiv,mkup);var slidercontroller=vc_app.getSliderController();var o=document.getElementById(self.getID()).getElementsByTagName("dd");var c=o[1].getElementsByTagName("div");var s=slidercontroller.createSlider(self,c[3],self.getMinmaxStr(),c[1],null,null,c[0],c[2]);s.setCallbacks(setSliderStatus,sliderValueChanged);s.disableCurMark();s.disableQMark();var defval=self.getDataItem().getValue();s.initValue(defval,true)};this.createASliderWInput=function(parentdiv){var defval=self.getDataItem().getValue();var uiid=self.getElid();var uiclass=self.getUIClass();var mkup='<dl class="'+uiclass+'_dl" id="sl'+uiid+'">';mkup+='<dt class="'+uiclass+'_dt"><label for="'+uiid+'">'+self.markUpLabel(self.getUILabel())+"</label></dt>";mkup+='<dd class="'+uiclass+'rng" id="st'+uiid+'"></dd>';mkup+='<dd class="'+uiclass+'cntrl">';mkup+='<div class="'+uiclass+'decr"></div>';mkup+='<div class="'+uiclass+'bar6" title="Click to move here"></div>';mkup+='<div class="'+uiclass+'incr"></div>';mkup+='<div class="'+uiclass+'sldr" title="'+self.getUILabel()+'"></div>';mkup+='<div class="'+uiclass+'incvr"></div>';mkup+="</dd>";mkup+='<dd class="'+uiclass+'labs">';mkup+='<div class="'+uiclass+'labmin">'+formatit(self.getMinVal(),self.getDataFmt())+"</div>";mkup+='<div class="'+uiclass+'labmax">'+formatit(self.getMaxVal(),self.getDataFmt())+"</div>";mkup+="</dd>";mkup+="</dl>";mkup+='<div class="'+uiclass+'2end"></div>';self.appendCoverMarkup(parentdiv,mkup);var slidercontroller=vc_app.getSliderController();var o=document.getElementById(self.getID()).getElementsByTagName("dd");var c=o[1].getElementsByTagName("div");var s=slidercontroller.createSlider(self,c[3],self.getMinMaxStr(),c[1],c[4],null,c[0],c[2]);s.setCallbacks(setSliderStatus,sliderValueChanged);s.disableCurMark();s.disableQMark();vc_log.addToLog("slider being initialized to "+defval);s.initValue(defval,true)};this.setDataIntoUI=function(newval,upd,vec,r,c){var hasnovalue=(newval==null);newval=hasnovalue?"":newval;var fmt=self.getDataFmt(r,c);var el=null;var otype="";if(self.isUICollection()){el=document.getElementById(self.getElid()+"_"+r+"_"+c);otype=self.getCellUIType(r,c)}else{otype=self.getUIType();var eid=self.getElid()+(otype=="radiogrp"?("_"+newval+"_0"):"");el=document.getElementById(eid)}if(el){var taglc=el.tagName.toLowerCase();var fval=formatit(newval,fmt);if(otype=="input"){if(hasnovalue&&self.allowNoValue()){el.value=""}else{el.value=fval}}else{if(otype=="slider"||otype=="sliderwinput"){var s=vc_app.getSliderController().getSlider(self.getID());s.initValue(newval)}else{if(otype=="static"||otype=="inptable"){el.innerHTML=fval}else{if(otype=="embstatic"){var lab=self.getUILabel();lab=lab.replace("{data}",fval);el.innerHTML=lab}else{if(otype=="embdynamic"){var lab=self.replaceRefs(self.getUILabel());el.innerHTML=lab}else{if(otype=="graph"){el.src=fval}else{if(otype=="optin"){el.checked=(newval!=0)}else{if(otype=="select"||otype=="vselect"){var len=0;try{len=el.options.length}catch(error){len=0}for(var i=0;i<len;i++){if(i==newval){el.options[i].selected=true}else{el.options[i].selected=false}}}else{if(otype=="radiogrp"){el.checked=true}else{}}}}}}}}}}else{if(otype=="switchpanel"){self.displayPanels()}else{}}if(upd){self.updateData(newval,vec,r,c)}};this.updateData=function(newval,vec,r,c){var ditem=self.getDataItem();var otype=self.isUICollection()?self.getCellUIType(r,c):self.getUIType();if(otype!="select"&&otype!="radiogrp"){if(vec){ditem.setCellValue(r,c,newval)}else{ditem.setCurValue(newval)}}else{ditem.setCurValue(newval)}if(self.parpanel.isAutoRecalc()){vc_app.getAppView().recalculate(ditem.getID())}};this.aftAnimCB=function(){var newval=self.getValueFromUI();var slidercontroller=vc_app.getSliderController();var s=slidercontroller.getSlider(self.getID());s.initValue(newval)};this.getValueFromUI=function(){var el=document.getElementById(self.getElid());var taglc=el.tagName.toLowerCase();if(taglc=="input"){var v=el.value;var uv=v==""?(self.allowNoValue()?null:v):unformatit(v,self.getDataFmt(),this.emptyval);return uv}else{if(taglc=="select"){var len=el.options.length;for(var i=0;i<len;i++){if(el.options[i].selected==true){return i}}}}return 0};this.selectContents=function(elid){if(self.isInputType()){var el=document.getElementById(elid?elid:self.getElid());if(el){el.focus();el.select()}}};this.getCellValueFromUI=function(r,c){var el=document.getElementById(self.getElid()+"_"+r+"_"+c);var otype=self.getCellUIType(r,c);var taglc=el.tagName.toLowerCase();if(otype=="optin"){return el.checked?1:0}else{if(taglc=="input"){var v=el.value;var uv=v==""?(self.allowNoValue()?null:v):unformatit(v,self.getDataFmt(r,c),this.emptyval);return uv}}return 0};this.validateSelection=function(){var el=document.getElementById(self.getElid());if(el){var nopts=el.options.length;var ct=0;var sellist="";for(var i=0;i<nopts;i++){if(el.options[i].selected){ct++;sellist+=el.options[i].value+";"}}if(ct==0||(ct==1&&sellist=="SELECT;")){return true}}return false};this.validateSelectionCell=function(r,c){return false};this.validateVal=function(uiid,uv,showalert){return self.validateCell(uiid,uv,0,0,showalert)};this.isInputType=function(){var uitype=self.getUIType();return uitype=="input"||uitype=="sliderwinput"||uitype=="inptable"};this.validateCell=function(elementid,uv,r,c,showalert){var el=document.getElementById(elementid);var retval=true;if(uv!=null||!self.allowNoValue()){var dtype=self.getDataType(r,c);var uitype=self.getUIType();if(self.isInputType()){var ttl=self.getTitle()?self.getTitle():"";if(dtype=="num"||dtype=="pct"){if(ttl.length>0){ttl=" for "+ttl}var v=parseFloat(uv);if(isNaN(v)){self.setErrorStr(uv==""?("Please enter a value"+ttl+"."):("Please remove the extra characters found in the numeric field"+ttl+"."));retval=false}else{var minv=self.getMinVal(r,c);var maxv=self.getMaxVal(r,c);var fmt=self.getDataFmt(r,c);if(minv>uv||maxv<uv){var mn=formatit(minv,fmt);var mx=formatit(maxv,fmt);self.setErrorStr("Please enter a value between "+mn+" and "+mx+ttl+".");retval=false}else{var varval=self.getValidationCB();if(varval){var errstr=eval(varval+"(uv, r, c)");if(errstr!=""){self.setErrorStr(errstr);retval=false}}}}}else{if(dtype=="dat"){var v=new Date(uv);if(isNaN(v.getTime())){self.setErrorStr("Invalid date entered. Please make sure you enter the date as mm/dd/yyyy");retval=false}else{var varval=self.getValidationCB();if(varval){var errstr=eval(varval+"(uv, r, c)");if(errstr!=""){self.setErrorStr(errstr);retval=false}}}}else{if(dtype=="str"){if(ttl.length>0){ttl=" for "+ttl}if(uv==""){self.setErrorStr("Please enter a value"+ttl+".");retval=false}else{if(uv.length>self.getMaxLen()){self.setErrorStr("Please limit the string to "+self.getMaxLen()+" characters"+ttl+".");retval=false}}}}}}}if(retval){self.setErrorInElement(el,false,r,c)}else{self.setErrorInElement(el,true,r,c);if(showalert){showPopError()}}return retval};this.setErrorInElement=function(el,e,r,c){if(el){if(e==true){el.style.backgroundColor="#ff0000";el.style.color="#ffffff";self.errsubel=self.isUICollection()?(r+","+c):"";self.setError(true)}else{el.style.backgroundColor="#ffffff";el.style.color="#0C4877";var comp=self.isUICollection()?(r+","+c):"";if(self.errsubel==comp){self.setError(false)}}}};this.setError=function(torf){self.error=torf;if(torf==false){self.setErrorStr(null)}};if(self.o.byrow){self.byrow=self.o.byrow}if(self.o.addhelp){self.addhelp=self.o.addhelp}var v=null;if(self.o.minvals==undefined){self.o.minvals=""}if(self.o.maxvals==undefined){self.o.maxvals=""}if(self.o.incvals==undefined){self.o.incvals=""}if(self.o.defvals==undefined){self.o.defvals=""}if(self.o.dtypes==undefined){self.o.dtypes=""}if(self.o.dfmts==undefined){self.o.dfmts=""}v=self.o.minvals+"";self.minvals=v.split(",");v=self.o.maxvals+"";self.maxvals=v.split(",");v=self.o.incvals+"";self.incvals=v.split(",");v=self.o.defvals+"";self.defvals=v.split(",");v=self.o.dtypes+"";self.dtypes=v.split(",");v=self.o.dfmts+"";self.dfmts=v.split(",");if(self.o.uitypes!=undefined){v=self.o.uitypes+"";self.uitypes=v.split(",")}if(self.o.edits!=undefined){v=self.o.edits+"";self.edits=v.split(",")}if(self.o.uiclasses!=undefined){v=self.o.uiclasses+"";self.uiclasses=v.split(",")}if(self.o.hide!=undefined){v=self.o.hide+"";self.hiddenrc=v.split(",")}if(self.o.ridx!=undefined){self.ridx=self.o.ridx}if(self.o.cidx!=undefined){self.cidx=self.o.cidx}if(self.isMultiSolveItem()){self.parpanel.addToMSOList(self)}if(self.isMultiSolveCtrl()){self.parpanel.setMSOCtrl(self)}}function setSliderStatus(c,d){}function sliderValueChanged(k,l,m,j){var c=vc_app.getAppView().getItem(k);if(c.hasErrors()){var h=c.getElid()+((m==undefined||j==undefined)?"":("_"+m+"_"+j));c.setErrorInElement(document.getElementById(h),false,m,j)}if(m==undefined||j==undefined){m=0;j=0}c.updateData(l,false,m,j)}function sliderInputChanged(g){try{var f=vc_app.getAppView().getItem(g);var h=f.getValueFromUI();if(f.validateVal(f.getElid(),h,true)){f.updateData(h,false,0,0)}else{vc_log.addToLog(document.activeElement.id+" is the active element id");window.setTimeout(f.selectContents,50);return false}}catch(e){}}function cellChecked(k,m,j){var c=vc_app.getAppView().getItem(k);var l=c.getCellValueFromUI(m,j);var h=c.getElid()+"_"+m+"_"+j;if(c.validateCell(h,l,m,j,true)){c.updateData(l,true,m,j)}else{c.selectContents(h);return false}}function valueChanged(g){try{var f=vc_app.getAppView().getItem(g);var h=f.getValueFromUI();if(f.validateVal(f.getElid(),h,true)){f.updateData(h,false,0,0)}else{vc_log.addToLog(document.activeElement.id+" is the active element id");window.setTimeout(f.selectContents,50);return false}}catch(e){}}function selectValueChanged(g){try{var f=vc_app.getAppView().getItem(g);var h=f.getValueFromUI();f.updateData(h,false,0,0)}catch(e){}}function msolValueChanged(j){try{var l=vc_app.getAppView();var g=l.getItem(j);var k=g.getValueFromUI();var h=g.getDataItem();l.setMSO(g.isByRow()?h.getRowHeader(k):h.getColHeader(k));g.updateData(k,false,0,0)}catch(m){}}function boxClicked(h,k){var g=vc_app.getAppView().getItem(h);var f=document.getElementById(g.getElid()+"_"+k);if(f){var j=f.checked?1:0;g.setDataIntoUI(j,true,false,k,0)}}function radioClicked(g,f){var e=vc_app.getAppView().getItem(g);var h=document.getElementById(e.getElid()+"_"+f+"_0");if(h){e.setDataIntoUI(f,true,false,f,0)}}function handleBtnClick(b){location.href=b}function callJSFunction(f){eval(f)}function handleAction(l,r){if(l=="switchpanel"){var s=r.split(",");var q=s.length;var a=new Array();for(var o=0;o<q;o++){var n=s[o].split("=");a[n[0]]=n[1]}var m=vc_app.getAppView().getItem(a.uiid);var p=m.getDataItem();if(p!=null){p.setValue(a.newval);vc_app.getAppView().recalculate();vc_app.getAppView().refreshUI()}}}function switchThePanel(h,g){var k=h.length;for(var l=0;l<k;l++){var j=document.getElementById(h[l]);if(j){var m=(l==g)?"block":"none";j.style.display=m}}}function validateSilently(g){var l=document.getElementById(g);var h=true;if(l){var j=l.tagName.toLowerCase();if(j=="input"){var k=vc_app.getAppView().getItem(g);if(k){if(k.dtype=="num"||k.dtype=="pct"){var m=parseFloat(l.value);h=!isNaN(m)}else{if(k.dtype=="dat"){var m=new Date(l.value);h=!isNaN(m.getTime())}}}else{h=false}}}else{h=false}return h}function appendMarkup(f,e){var d=document.getElementById(f);if(d){d.innerHTML+=e}else{}}function roundit(h,e){var g=h/e;var f=Math.round(g)*e;return f}function zpad(f,d){var e=f;if(d){if(f<10){e="00"+f}else{if(f<100){e="0"+f}}}return e}function thous(q,r){var l=[];var s=q-Math.floor(q);if(r>0){q=Math.floor(q);if(s>=1){q++}}var n=0;for(var p=1000000000;p>1;){var o=new Number(Math.floor(q/p));if(o>0||n>0){l[n]=zpad(o,n>0);q=q%p;n++}p=p/1000}l[n]=zpad(q,n>0);var m=l.join(",");if(r>0){var j=s.toFixed(r);m+=j.substring(1)}return m}function formatit(m,r){if(r.indexOf("%")==0){if(isNaN(m)){m=0}m=new Number(m*100);var q=2;try{q=new Number(r.length>2?r.substring(2)*1:2)}catch(o){q=2}m=m.toFixed(q);m=m+"%"}else{if(r.indexOf("$")==0||r.indexOf("#")==0){var q=0;if(r.indexOf("$.")==0){try{q=new Number(r.length>2?r.substring(2)*1:0)}catch(o){q=0}}else{if(r.indexOf("#.")==0){var l=r.split(".");try{q=new Number(l[1]*1)}catch(o){q=0}}}var k=(r.indexOf("$")==0);var s=false;var p=new Number((q>0?m.toFixed(q):Math.round(m)));if(p<0){p=-p;s=true}var n=thous(p,q);if(k){n="$"+n}if(s){n="-"+n}return n}}return m}function formatitdbg(l,r){if(r=="$"){var s=false;var j=[];var q=new Number(Math.round(l));if(q<0){q=-q;s=true}var n=0,p=1000000;var o=new Number(Math.floor(q/p));if(o>0){j[n]=zpad(o,n);alert(j[n]);q=q%p;n++}p/=1000;o=new Number(Math.floor(q/p));if(n>0||o>0){j[n]=zpad(o,n);alert(j[n]);q=q%p;n++}j[n]=zpad(q,n);alert(j[n]);var m=j.join(",");m="$"+m;if(s){m="-"+m}return m}else{if(r=="%"){l=new Number(l*100);l=l.toFixed(2);l=l+"%"}}return l}function unformatit(f,e,d){if(e.indexOf("%")==0){f=f.replace("%","");return new Number(f/100)}else{if(e.indexOf("$")==0||e.indexOf("#")==0){f=f.replace(/,/g,"");f=f.replace("$","");return new Number(f)}else{if(e.indexOf("*")==0){return f}}}if(f==""){f=d}return new Number(f)}var savemarkup="";function showmarkup(){var b=document.getElementById("debug");if(b){savemarkup=savemarkup.replace(/</g,"[");savemarkup=savemarkup.replace(/>/g,"]");b.innerHTML=savemarkup}}var defbundle=[{id:"h_unk",title:"Unknown help topic",descr:"<p>An unknown help topic was found</p>"}];function showHelp(c,d){helpObj.showAppHelp(c,d)}function showPopError(){var c=document.getElementById("poperror");if(c){var d=vc_app.getAppView().getErrorStr();document.getElementById("el_poperror").innerHTML=d;c.style.display="block"}}function hidePopError(){var b=document.getElementById("poperror");if(b){b.style.display="none"}}function getElsByClassName(l){var j=new Array();var k=document.getElementsByTagName("*");for(var m=0;m<k.length;m++){if(k[m].className.indexOf(" ")>=0){var g=k[m].className.split(" ");for(var h=0;h<g.length;h++){if(g[h]==l){j.push(k[m])}}}else{if(k[m].className==l){j.push(k[m])}}}return j}function helpObject(c){var d=this;this.hidlatch=null;this.helpbundle=c==null?defbundle:c;this.findHelpElement=function(b){for(var a=0;a<d.helpbundle.length;a++){if(d.helpbundle[a].id==b){return d.helpbundle[a]}}return d.helpbundle[d.helpbundle.length-1]};this.showHelpPopup=function(l,m){var b=d.findHelpElement(m);if(b.descr==undefined){b.descr=b.title}var j=document.getElementById("helppopup");if(j){var a=vc_app.getImageLoc();var k="";k+='<div class="helpcontent"><table width="100%" cellpadding=0 cellspacing=0><tr class=helptitlerow><td width=20>&nbsp;</td><td align=left class=helptitle>'+b.title+"</td><td width=20>&nbsp;</td></tr><tr><td width=20>&nbsp;</td><td align=left class=helpdesc>"+b.descr+"</td><td width=20>&nbsp;</td></tr><tr><td></td></tr></table></div>";k+='<div class="helpnav"><table width="100%"><tr><td></td></tr><tr><td align=right><a onmouseover="this.style.cursor=\'pointer\'" onfocus="this.blur();" onclick="hideHelpPopup (\''+m+'\')"><img src="'+a+'close.png"></a>&nbsp;</td></tr></table></div>';j.innerHTML=k;if(m!=hidlatch){d.hideHelpPopup(hidlatch)}j.style.zIndex="2001";j.style.display="block";j.style.marginTop="-15px";d.hidlatch=m}else{}};this.hideHelpPopup=function(f){if(f==null){return}var a=document.getElementById("helppopup");if(a){var b="";a.style.display="none";a.innerHTML=b;a.style.zIndex="2000";d.hidlatch=null}}}function SliderController(f,e){var d=this;this.animatestatus=true;this.controls=new Array();this.fbIE=null;this.isIE=(navigator.appVersion.indexOf("MSIE")+1);this.isOpera=(navigator.userAgent.toLowerCase().indexOf("opera")+1);if(this.isOpera){this.isIE=false}this.getSlider=function(a){return d.controls[a]};this.destructor=function(){for(var a=d.controls.length;a--;){d.controls[a].destructor()}if(d.isIE){d.fbIE.onmouseover=null;d.fbIE.onmouseout=null;d.fbIE=null}d.controls=null;d.o=null};this.createSlider=function(t,r,b,p,o,s,c,q){var a=new Slider(t,null,r,b,p,o,s,null,null,null,null,c,q);var u=t.getID();this.controls[u]=a;return a};this.setAnimateStatus=function(a){d.animatestatus=a};this.shouldAnimateStatus=function(){return d.animatestatus};if(d.isIE){d.fbIE=$("fireButton");d.fbIE.onmouseover=function(){this.className="hover"};d.fbIE.onmouseout=function(){this.className=""}}}function Slider(B,C,z,s,u,y,x,w,q,v,t,A,r){var o=this;this.oID="sc"+(gOID++);this.sob=B;this.o=z;this.oV=s;this.oB=u;this.oI=y;this.oInc=x;this.oC=w;this.oQ=q;this.oCL=v;this.oQL=t;this.oDecr=A;this.decrClassName=this.oDecr==null?"":this.oDecr.className;this.oIncr=r;this.incrClassName=this.oIncr==null?"":this.oIncr.className;this.valueOptions=s.split(":");this.vrng=this.valueOptions[1]-this.valueOptions[0];this.value=0;this.xMin=0;this.xMax=u.offsetWidth-1;this.prng=this.xMax-this.xMin;this.x=0;this.pperv=this.prng/this.vrng;this.vperp=this.vrng/this.prng;this.vincr=this.valueOptions[2];this.ppervincr=this.pperv*this.vincr;this.offX=0;this.curmark=0;this.statusCB=null;this.changeCB=null;this.timer=null;this.decrtimer=null;this.incrtimer=null;this._className=this.o.className;this.tween=[];this.frame=0;this.slid=B.getID();this.enabled=true;this.aftanimCB=null;this.aftanimV;if(this.valueOptions[3]=="map"){this.isdiscrete=true;this.cats=C}else{this.isdiscrete=false;this.cats=null}this.isIE=(navigator.appVersion.indexOf("MSIE")+1);this.isOpera=(navigator.userAgent.toLowerCase().indexOf("opera")+1);if(this.isOpera){this.isIE=false}this.setIdentity=function(a){o.slid=a};this.setCatList=function(a){o.cats=a};this.setCallbacks=function(a,b){o.statusCB=a;o.changeCB=b};this.over=function(){if(o.enabled){this.className=o._className+" hover"}event.cancelBubble=true;return false};this.out=function(){this.className=o._className;event.cancelBubble=true;return false};this.calcOffX=function(a){o.offX=a+o.oB.offsetLeft-(o.o.offsetLeft+hmarkw)};this.down=function(a){var b=a?a:event;o.calcOffX(b.clientX);addEventHandler(document,"mousemove",o.move);addEventHandler(document,"mouseup",o.up);return false};this.getPageXOffset=function(){if(typeof window.pageXOffset==="undefined"){var e=document.documentElement.scrollLeft;if(document.body.getBoundingClientRect){var b=document.body.getBoundingClientRect();var a=b.right-b.left;var d=document.body.offsetWidth;var c=Math.round((a/d)*100)/100;e=e/c}return e}else{return window.pageXOffset}};this.getOffset=function(b,a){if(!b){return}a.xo+=b.offsetLeft;a.yo+=b.offsetTop;o.getOffset(b.offsetParent,a)};this.getScrolled=function(b,a){if(!b){return}a.xo+=b.scrollLeft;a.yo+=b.scrollTop;o.getScrolled(b.offsetParent,a)};this.barClick=function(g){var d=g?g:event;var a=o.o.parentNode.offsetLeft;var j=o.o.parentNode.parentNode.offsetLeft;var h=o.getPageXOffset();var f=(d.clientX+h)-(a+j+o.oB.offsetLeft);var c={xo:0,yo:0};o.getOffset(o.oB,c);var b={xo:0,yo:0};o.getScrolled(o.oB,b);var k=d.clientX-c.xo+b.xo;var e=o.ptov(Math.max(0,k));o.slide(o.value,e)};this.fireChange=function(){if(o.changeCB!=null){o.changeCB(o.slid,o.value)}};this.moveSlider=function(a){var c=a-o.offX;if(c>o.xMax){c=o.xMax}else{if(c<o.xMin){c=o.xMin}}if(c!=o.x){var b=o.ptov(c);o.moveTo(b);o.doUpdate()}};this.move=function(a){var b=a?a:event;o.moveSlider(b.clientX);b.stopPropagation?b.stopPropagation():b.cancelBubble=true;return false};this.up=function(a){removeEventHandler(document,"mousemove",o.move);removeEventHandler(document,"mouseup",o.up);o.fireChange();o.updateStatus()};this.slide=function(b,a){o.tween=sldranimator.createTween(b,a);sldranimator.enqueue(o,o.animate,o.fireChange);sldranimator.start()};this.slidewocallback=function(b,a){o.tween=sldranimator.createTween(b,a);sldranimator.enqueue(o,o.animate,null);sldranimator.start()};this.moveTo=function(a){o.value=a;var b=o.vtop(a);o.o.style.marginLeft=(b-hmarkw)+"px"};this.animate=function(){o.moveTo(o.tween[o.frame].data);o.doUpdate(50);if(o.frame++>=o.tween.length-1){o.active=false;o.frame=0;o.doUpdate();if(o._oncomplete){o._oncomplete()}if(o.aftanimCB!=null){o.aftanimCB()}return false}return true};this.doUpdate=function(a){if(!o.timer){o.timer=setTimeout(o.update,a||20)}};this.update=function(){o.updateslider(true,sldranimator.isAnimating())};this.updatewithforce=function(){o.updateslider(true,sldranimator.isAnimating())};this.updateslider=function(a,b){o.timer=null;o.x=o.vtop(o.value);o.showstatus(o.value,a,b);o.updateStatus()};this.showstatus=function(f,c,d){var b=o.valueOptions[0];var a=o.valueOptions[1];if(f<b){f=b}if(f>a){f=a}if((f!=o.value)||c){o.value=f*1;if(o.isdiscrete){if(f==o.curmark){f="Current";o.value=f}else{f=o.mapValue(f)}}else{var e=sldrcontroller.shouldAnimateStatus();if(o.statusCB!=null&&(e||!d)){f=o.statusCB(o.slid,f)}}o.oV.innerHTML=f}};this.updateStatus=function(){if(o.oI){var b=o.sob.getElid();var a=document.getElementById(b);if(a){a.value=formatit(o.value,o.sob.getDataFmt())}}};this.mapValue=function(a){return o.cats[a-o.valueOptions[0]].name};this.getMapIndex=function(b){for(var a=0;a<o.cats.length;a++){if(o.cats[a].id==b){return a}}return 0};this.getMapID=function(a){return o.cats[a].id};this.initValue=function(d,a){var b=typeof(a)!=="undefined"&&a!=false;var c=o.value;if(isNaN(d)){d=c}if(b||c!=d){if(d<o.valueOptions[0]){d=o.valueOptions[0]}else{if(d>o.valueOptions[1]){d=o.valueOptions[1]}}if(o.active&&vc_log.isDebugMode()){vc_log.addToLog("animation not yet complete (frame:"+o.frame+")");o.aftanimCB=o.callAfterAnimation;o.aftanimV=d;return}o.slidewocallback(c,d);o.value=d;vc_log.addToLog("value in slider:"+o.value);o.showstatus(d,true)}o.updateStatus()};this.callAfterAnimation=function(){o.aftanimCB=null;o.initValue(o.aftanimV)};this.setCurMark=function(c){if(o.oC!=null){o.curmark=c;var d=o.vtop(c);var e=(o.isdiscrete)?18:46;var b=d-e;var a=d+e;if(b<0){b=0}else{if(a>o.xMax){b=o.xMax-2*e}}o.oC.style.marginLeft=(d-hmarkw)+"px";o.oCL.style.marginLeft=b+"px"}};this.setQMark=function(c){if(o.oQ!=null){o.qmark=c;var d=o.vtop(c);var e=34;var b=d-e;var a=d+e;if(b<0){b=0}else{if(a>o.xMax){b=o.xMax-2*e}}o.oQ.style.marginLeft=(d-hmarkw)+"px";o.oQL.style.marginLeft=b+"px"}};this.disableSlider=function(){o.enabled=false;o.disableQMark();o.disableCurMark();o.disableThumb();o.setCallbacks(o.disabledStatusCB,null);o.updatewithforce()};this.disabledStatusCB=function(){return"Changes not allowed"};this.disableQMark=function(){if(o.oQ!=null){o.oQ.style.display="none";o.oQL.style.display="none";this.oQ.onclick=null}};this.disableCurMark=function(){if(o.oC!=null){o.oC.style.display="none";this.oC.onclick=null}};this.disableThumb=function(){o.o.style.display="none";this.o.onmousedown=null;this.oB.onclick=null};this.vtop=function(a){if(o.isdiscrete){a=o.getMapIndex(a)}else{a-=0}if(a<o.valueOptions[0]){return o.xMin}if(a>o.valueOptions[1]){return o.xMax}if(o.isdiscrete){return 0+((a-o.valueOptions[0])/o.vrng*(o.xMax-o.xMin)+o.xMin)}else{return parseInt(Math.round((a-o.valueOptions[0])*o.pperv))}};this.mapvtop=function(a){if(a<0){return o.xMin}if(a>o.valueOptions[1]-o.valueOptions[0]){return o.xMax}return 0+((a-o.valueOptions[0])/o.vrng*(o.xMax-o.xMin)+o.xMin)};this.ptov=function(b){if(o.isdiscrete){var a=((b-o.xMin)/(o.xMax-o.xMin)*o.vrng)+parseInt(o.valueOptions[0]);var c=Math.round(a);return o.cats[c].idx}else{return parseInt(Math.round(b*o.vperp/o.vincr))*o.vincr+(o.valueOptions[0]-0)}};this.destructor=function(){o.o.onmouseover=null;o.o.onmouseout=null;o.o.onmousedown=null;o.o.ontouchstart=null;o.o=null;o.oV=null;o.oB.onclick=null;o.oB=null;if(o.oDecr!=null){o.oDecr.onmousedown=null;o.oDecr.onmouseover=null;o.oDecr.onmouseout=null;o.oDecr.ontouchstart=null}if(o.oIncr!=null){o.oIncr.onmousedown=null;o.oIncr.onmouseover=null;o.oIncr.onmouseout=null;o.oIncr.ontouchstart=null}};this.showDecrHoverStyle=function(){if(o.enabled){this.className=o.decrClassName+" hover"}return false};this.showDecrNormalStyle=function(){this.className=o.decrClassName;return false};this.showIncrHoverStyle=function(){if(o.enabled){this.className=o.incrClassName+" hover"}return false};this.showIncrNormalStyle=function(){this.className=o.incrClassName;return false};this.decrementValue=function(){var c=o.x-Math.ceil(o.ppervincr);var a=false;if(c>o.xMax){c=o.xMax;a=true}else{if(c<o.xMin){c=o.xMin;a=true}}if(c!=o.x){var b=o.ptov(c);o.moveTo(b);o.doUpdate()}if(a){o.stopDecrement()}};this.startDecrement=function(){o.decrementValue();o.decrtimer=setInterval(o.decrementValue,200)};this.stopDecrement=function(){if(o.decrtimer!=null){clearInterval(o.decrtimer);o.decrtimer=null}o.fireChange()};this.mouseStartDecrement=function(a){o.startDecrement();addEventHandler(document,"mouseup",o.mouseStopDecrement);return false};this.mouseStopDecrement=function(a){removeEventHandler(document,"mouseup",o.mouseStopDecrement);o.stopDecrement();return false};this.touchStartDecrement=function(a){a.preventDefault();o.showDecrHoverStyle();o.startDecrement();addEventHandler(o.oDecr,"touchend",o.touchStopDecrement);addEventHandler(o.oDecr,"touchcancel",o.touchStopDecrement)};this.touchStopDecrement=function(a){a.preventDefault();removeEventHandler(o.oDecr,"touchend",o.touchStopDecrement);removeEventHandler(o.oDecr,"touchcancel",o.touchStopDecrement);o.stopDecrement();o.showDecrNormalStyle()};this.incrementValue=function(){var c=o.x+Math.ceil(o.ppervincr);var a=false;if(c>o.xMax){c=o.xMax;a=true}else{if(c<o.xMin){c=o.xMin;a=true}}if(c!=o.x){var b=o.ptov(c);o.moveTo(b);o.doUpdate()}if(a){o.stopIncrement()}};this.startIncrement=function(){o.incrementValue();o.incrtimer=setInterval(o.incrementValue,200)};this.stopIncrement=function(){if(o.incrtimer!=null){clearInterval(o.incrtimer);o.incrtimer=null}o.fireChange()};this.mouseStartIncrement=function(a){o.startIncrement();addEventHandler(document,"mouseup",o.mouseStopIncrement);return false};this.mouseStopIncrement=function(a){removeEventHandler(document,"mouseup",o.mouseStopIncrement);o.stopIncrement();return false};this.touchStartIncrement=function(a){a.preventDefault();o.showIncrHoverStyle();o.startIncrement();addEventHandler(o.oIncr,"touchend",o.touchStopIncrement);addEventHandler(o.oIncr,"touchcancel",o.touchStopIncrement)};this.touchStopIncrement=function(a){a.preventDefault();removeEventHandler(o.oIncr,"touchend",o.touchStopIncrement);removeEventHandler(o.oIncr,"touchcancel",o.touchStopIncrement);o.stopIncrement();o.showIncrNormalStyle()};this.touchStartDrag=function(a){a.preventDefault();o.over();o.calcOffX(a.targetTouches[0].clientX);addEventHandler(o.o,"touchmove",o.touchMoveDrag);addEventHandler(o.o,"touchend",o.touchStopDrag);addEventHandler(o.o,"touchcancel",o.touchStopDrag)};this.touchMoveDrag=function(a){a.preventDefault();o.moveSlider(a.targetTouches[0].clientX);evt.stopPropagation?evt.stopPropagation():evt.cancelBubble=true};this.touchStopDrag=function(a){a.preventDefault();o.out();removeEventHandler(o.o,"touchmove",o.touchMoveDrag);removeEventHandler(o.o,"touchend",o.touchStopDrag);removeEventHandler(o.o,"touchcancel",o.touchStopDrag);o.fireChange();o.updateStatus()};this.init=function(){if(o.oI!=null){var a=o.sob.getElid();var c=o.sob.getUIClass();var d=o.slid;var b=createElement(a,c+"_sl","",o.oI,"input");b.type="text";b.value="";o.sob.hookValueChgHandlers(b)}if(o.isIE){this.o.onmouseover=this.over;this.o.onmouseout=this.out}this.o.onmousedown=this.down;this.o.ontouchstart=this.touchStartDrag;this.oB.onclick=this.barClick;if(this.oC!=null){this.oC.onclick=this.barClick}if(this.oQ!=null){this.oQ.onclick=this.barClick}if(this.oDecr!=null){this.oDecr.onmousedown=this.mouseStartDecrement;this.oDecr.onmouseover=this.showDecrHoverStyle;this.oDecr.onmouseout=this.showDecrNormalStyle;this.oDecr.ontouchstart=this.touchStartDecrement}if(this.oIncr!=null){this.oIncr.onmousedown=this.mouseStartIncrement;this.oIncr.onmouseover=this.showIncrHoverStyle;this.oIncr.onmouseout=this.showIncrNormalStyle;this.oIncr.ontouchstart=this.touchStartIncrement}o.value=0;o.update()};o.init()}function SliderAnimator(){var b=this;this.tweens=[];this.tweens["default"]=[1,2,3,4,5,6,7,8,9,10,9,8,7,6,5,4,3,2,1];this.tweens.blast=[12,12,11,10,10,9,8,7,6,5,4,3,2,1];this.tweens.fade=[10,10,10,10,10,10,10,10,10,10];this.queue=[];this.queue.IDs=[];this.active=false;this.timer=null;this.isAnimating=function(){return b.active};this.createTween=function(k,q,m){m=m||"fade";var n=[k];var o=k;var l=q-k;var a=b.tweens[m].length;for(var p=0;p<a;p++){o+=l*b.tweens[m][p]*0.01;n[p]=new Object();n[p].data=o;n[p].event=null}return n};this.enqueue=function(f,a,h){if(!a){}var g;if(typeof(b.queue.IDs[f.oID])=="undefined"){g=b.queue.length;b.queue.IDs[f.oID]=g;b.queue[g]=f}else{g=b.queue.IDs[f.oID];b.queue[g].active=true;b.queue[g].frame=0}f.active=true;b.queue[g]._method=a;b.queue[g]._oncomplete=h?h:null};this.animate=function(){var d=0;for(var a=b.queue.length;a--;){if(b.queue[a].active){b.queue[a]._method();d++}}if(d==0&&b.timer){b.stop()}else{}};this.start=function(){if(b.timer||b.active){return false}b.active=true;b.timer=setInterval(b.animate,intervalRate)};this.stop=function(){clearInterval(b.timer);b.timer=null;b.active=false;b.queue=[];b.queue.IDs=[]}}var gOID=0;var sldrcontroller=null;var sldranimator=null;var intervalRate=5;var hmarkw=10;function addEventHandler(f,d,e){typeof(attachEvent)=="undefined"?f.addEventListener(d,e,false):f.attachEvent("on"+d,e)}function removeEventHandler(f,d,e){typeof(attachEvent)=="undefined"?f.removeEventListener(d,e,false):f.detachEvent("on"+d,e)}function createSliderController(){if(sldrcontroller!=null){destroySliderController()}sldrcontroller=new SliderController();if(sldranimator==null){sldranimator=new SliderAnimator()}return sldrcontroller}function destroySliderController(){if(sldrcontroller!=null&&sldrcontroller!="null"){sldrcontroller.destructor()}sldrcontroller=null}addEventHandler(window,"unload",destroySliderController);function VCMath(){var b=this;this.fvs=function(h,l,m){var k=1+l*1;var j=m*1;var a=h*1;return Math.pow(k,j)*a};this.fvp=function(l,m,o,n){var k=m*1;if(k*1<=0){return l*o}var j=o*1;var a=l*1;return((Math.pow(k+1,j)-1)*a*(k*n+1)/k)};this.pvs=function(h,l,m){var k=l*1;var j=m*1;var a=h*1;return Math.pow(k+1,-j)*a};this.pvp=function(a,h,k){var l=a*1;var j=k*1;var m=h*1;if(j<=0){return m}if(l<=0){return m*j}return((1-Math.pow(1+l,-j))*m/l)};this.pva=function(o,l,p,q){var m=p*1;var n=l*1;if(m<=n){return o*q}var g=q*1;var a=o*1;return a/(m-n)*(1+m-Math.pow(1+n,g)/Math.pow(1+m,g-1))};this.fvg=function(q,n,o,r,g){var u=o*1;var p=n*1;var t=r*1;var a=q*1;var s=0;if(t<1){t=1}if(u<=0){u=0}if(u==p){s=a*t*Math.pow(1+u,t-1)}else{s=a*(Math.pow(1+u,t)-Math.pow(1+p,t))/(u-p)}if(g==1){s*=(1+u)}return s};this.annuityg=function(n,a,g,r,p){var u=n*1;var q=a*1;var s=r*1;var o=g*1;var t=0;if(s<1){s=1}if(u<=0){u=0}if(p==0){if(u==q){t=o/s}else{t=(u-q)*o/(1+u-Math.pow(1+q,s)/Math.pow(1+u,s-1))}}else{if(u==q){t=o*(1+u)/s}else{t=(u-q)*o/(1-Math.pow((1+q)/(1+u),s))}}return t}}var visiblehtmlpopup=null;var visiblepanelpopup=null;function showHtmlPopup(e,d){if(e==null||e==visiblehtmlpopup){return}self.hidePopup();$("#htmlpopup").load(e);var f=document.getElementById("htmlpopup");if(f){if(d){self.showModalBackground()}f.style.display="block";f.style.zIndex="2002";f.style.marginTop="-15px";visiblehtmlpopup=e}}function showPanelPopup(f,e){if(f==null||f==visiblepanelpopup){return}self.hidePopup();var d=document.getElementById(f);if(d){if(e){self.showModalBackground()}d.style.display="block";d.style.zIndex="2002";d.style.marginTop="-15px";visiblepanelpopup=f}}function showModalBackground(){var c=document.getElementById("vcmodalbkgd");if(c==null){var d=document.getElementsByTagName("body");if(d&&d.length>0){c=document.createElement("div");c.id="vcmodalbkgd";c.className="modalbackground";c.style.display="block";c.style.zIndex="2001";d[0].appendChild(c)}else{}}else{c.style.display="block";c.style.zIndex="2001"}}function hidePopup(){var d=document.getElementById("htmlpopup");if(d){d.style.display="none";d.style.zIndex="2000";d.innerHTML="";visiblehtmlpopup=null}if(visiblepanelpopup){var d=document.getElementById(visiblepanelpopup);if(d){d.style.display="none";d.style.zIndex="2000";visiblepanelpopup=null}}var c=document.getElementById("vcmodalbkgd");if(c){c.style.display="none";c.style.zIndex="2000"}}var vcccore_info="ver: 4.57.6335  built: 12/02/2014 at 19:14:34";